{
  "ID": "aws_codebuild_project_plaintext_env_variables_no_sensitive_aws_values",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "with invalid_key_name as (\n  select\n    distinct arn,\n    name\n  from\n    aws_codebuild_project,\n    jsonb_array_elements(environment -\u003e 'EnvironmentVariables') as env\n  where\n    env -\u003e\u003e 'Name' ilike any(array['%AWS_ACCESS_KEY_ID%', '%AWS_SECRET_ACCESS_KEY%', '%PASSWORD%'])\n    and env -\u003e\u003e 'Type' = 'PLAINTEXT'\n)\nselect\n  a.arn as resource,\n  case\n    when b.arn is null then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when b.arn is null then a.title || ' has no plaintext environment variables with sensitive AWS values.'\n    else a.title || ' has plaintext environment variables with sensitive AWS values.'\n  end as reason\n  \n  , a.region, a.account_id\nfrom\n  aws_codebuild_project as a\n  left join invalid_key_name b on a.arn = b.arn;\n",
  "Connector": "AWS",
  "PrimaryTable": "aws_codebuild_project",
  "ListOfTables": [
    "aws_codebuild_project"
  ]
}