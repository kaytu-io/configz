{
  "ID": "aws_iam_root_last_used",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "select\n  user_arn as resource,\n  case\n    when password_last_used \u003e= (current_date - interval '90' day) then 'alarm'\n    when access_key_1_last_used_date \u003c= (current_date - interval '90' day)  then 'alarm'\n    when access_key_2_last_used_date \u003c= (current_date - interval '90' day)  then 'alarm'\n    else 'ok'\n  end as status,\n  case\n    when password_last_used is null then 'Root never logged in with password.'\n    else 'Root password used ' || to_char(password_last_used , 'DD-Mon-YYYY') || ' (' || extract(day from current_timestamp - password_last_used) || ' days).'\n  end ||\n  case\n    when access_key_1_last_used_date is null then ' Access Key 1 never used.'\n    else ' Access Key 1 used ' || to_char(access_key_1_last_used_date , 'DD-Mon-YYYY') || ' (' || extract(day from current_timestamp - access_key_1_last_used_date) || ' days).'\n  end ||\n    case\n    when access_key_2_last_used_date is null then ' Access Key 2 never used.'\n    else ' Access Key 2 used ' || to_char(access_key_2_last_used_date , 'DD-Mon-YYYY') || ' (' || extract(day from current_timestamp - access_key_2_last_used_date) || ' days).'\n  end as reason\n  , account_id\nfrom\n  aws_iam_credential_report\nwhere\n  user_name = '\u003croot_account\u003e';\n",
  "Connector": "AWS",
  "PrimaryTable": "aws_iam_credential_report",
  "ListOfTables": [
    "aws_iam_credential_report"
  ]
}