{
  "ID": "aws_vpc_default_security_group_restricts_all_traffic",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "select\n  arn resource,\n  case\n    when jsonb_array_length(ip_permissions) = 0 and jsonb_array_length(ip_permissions_egress) = 0 then 'ok'\n    else 'alarm'\n  end status,\n  case\n    when jsonb_array_length(ip_permissions) \u003e 0 and jsonb_array_length(ip_permissions_egress) \u003e 0\n      then 'Default security group ' || group_id || ' has inbound and outbound rules.'\n    when jsonb_array_length(ip_permissions) \u003e 0 and jsonb_array_length(ip_permissions_egress) = 0\n      then 'Default security group ' || group_id || ' has inbound rules.'\n    when jsonb_array_length(ip_permissions) = 0 and jsonb_array_length(ip_permissions_egress) \u003e 0\n      then 'Default security group ' || group_id || ' has outbound rules.'\n    else 'Default security group ' || group_id || ' has no inbound or outbound rules.'\n  end reason\n  \n  , region, account_id\nfrom\n  aws_vpc_security_group\nwhere\n  group_name = 'default';\n",
  "Connector": "AWS",
  "PrimaryTable": "aws_vpc_security_group",
  "ListOfTables": [
    "aws_vpc_security_group"
  ]
}