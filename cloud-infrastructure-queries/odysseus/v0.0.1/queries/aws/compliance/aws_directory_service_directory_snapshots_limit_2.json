{
  "ID": "aws_directory_service_directory_snapshots_limit_2",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "select\n  arn as resource,\n  case\n    when snapshot_limit -\u003e\u003e 'ManualSnapshotsLimitReached' = 'true' then 'alarm'\n    when ((snapshot_limit -\u003e\u003e 'ManualSnapshotsLimit')::int - (snapshot_limit -\u003e\u003e 'ManualSnapshotsCurrentCount')::int) \u003c= 2 then 'alarm'\n    else 'ok'\n  end as status,\n  case\n    when snapshot_limit -\u003e\u003e 'ManualSnapshotsLimitReached' = 'true' then title || ' has reached ' || (snapshot_limit -\u003e\u003e 'ManualSnapshotsLimit') || ' snapshots limit.'\n    when ((snapshot_limit -\u003e\u003e 'ManualSnapshotsLimit')::int - (snapshot_limit -\u003e\u003e 'ManualSnapshotsCurrentCount')::int) \u003c= 2 then title || ' is about to reach its ' || (snapshot_limit -\u003e\u003e 'ManualSnapshotsLimit') || ' snapshot limit.'\n    else title || ' is using ' || (snapshot_limit -\u003e\u003e 'ManualSnapshotsCurrentCount') || ' out of ' || (snapshot_limit -\u003e\u003e 'ManualSnapshotsLimit') || ' snapshots limit.'\n  end as reason\n  \n  , region, account_id\nfrom\n  aws_directory_service_directory;\n",
  "Connector": "AWS",
  "PrimaryTable": "aws_directory_service_directory",
  "ListOfTables": [
    "aws_directory_service_directory"
  ]
}