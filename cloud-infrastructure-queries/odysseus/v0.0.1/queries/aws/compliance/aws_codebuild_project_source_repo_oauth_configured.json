{
  "ID": "aws_codebuild_project_source_repo_oauth_configured",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "select\n  p.arn as resource,\n  case\n    when p.source -\u003e\u003e 'Type' not in ('GITHUB', 'BITBUCKET') then 'skip'\n    when c.auth_type = 'OAUTH' then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when p.source -\u003e\u003e 'Type' = 'NO_SOURCE' then p.title || ' doesn''t have input source code.'\n    when p.source -\u003e\u003e 'Type' not in ('GITHUB', 'BITBUCKET') then p.title || ' source code isn''t in GitHub/Bitbucket repository.'\n    when c.auth_type = 'OAUTH' then p.title || ' using OAuth to connect source repository.'\n    else p.title || ' not using OAuth to connect source repository.'\n  end as reason\n  \n  , p.region, p.account_id\nfrom\n  aws_codebuild_project as p\n  left join aws_codebuild_source_credential as c on (p.region = c.region and p.source -\u003e\u003e 'Type' = c.server_type);\n",
  "Connector": "AWS",
  "PrimaryTable": "aws_codebuild_project",
  "ListOfTables": [
    "aws_codebuild_project",
    "aws_codebuild_source_credential"
  ]
}