{
  "ID": "aws_ec2_instance_no_launch_wizard_security_group",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "with launch_wizard_sg_attached_instance as (\n  select\n    distinct arn as arn\n  from\n    aws_ec2_instance,\n    jsonb_array_elements(security_groups) as sg\n  where\n    sg -\u003e\u003e 'GroupName' like 'launch-wizard%'\n)\nselect\n  i.arn as resource,\n  case\n    when sg.arn is null then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when sg.arn is null then i.title || ' not associated with launch-wizard security group.'\n    else i.title || ' associated with launch-wizard security group.'\n  end as reason\n  \n  , i.region, i.account_id\nfrom\n  aws_ec2_instance as i\n  left join launch_wizard_sg_attached_instance as sg on i.arn = sg.arn;\n",
  "Connector": "AWS",
  "PrimaryTable": "aws_ec2_instance",
  "ListOfTables": [
    "aws_ec2_instance"
  ]
}