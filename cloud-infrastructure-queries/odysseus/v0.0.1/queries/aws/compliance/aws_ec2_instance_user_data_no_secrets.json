{
  "ID": "aws_ec2_instance_user_data_no_secrets",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "select\n  arn as resource,\n  case\n    when user_data like any (array ['%pass%', '%secret%','%token%','%key%'])\n      or user_data ~ '(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?\u0026])[A-Za-z\\d@$!%*?\u0026]' then 'alarm'\n    else 'ok'\n  end as status,\n  case\n    when user_data like any (array ['%pass%', '%secret%','%token%','%key%'])\n      or user_data ~ '(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?\u0026])[A-Za-z\\d@$!%*?\u0026]' then instance_id ||' potential secret found in user data.'\n    else instance_id ||  ' no secrets found in user data.'\n  end as reason\n  \n  , region, account_id\nfrom\n  aws_ec2_instance;\n",
  "Connector": "AWS",
  "PrimaryTable": "aws_ec2_instance",
  "ListOfTables": [
    "aws_ec2_instance"
  ]
}