{
  "ID": "aws_tag_dimensions_sql.common_dimensions_qualifier_sql_multiple_global_trails",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "with global_trails as (\n  select\n    account_id,\n    count(*) as total\n  from\n    aws_cloudtrail_trail\n  where\n    is_multi_region_trail and region = home_region\n  group by\n    account_id,\n    is_multi_region_trail\n)\nselect\n  arn as resource,\n  case\n    when total \u003e 1 then 'alarm'\n    else 'ok'\n  end as status,\n  case\n    when total \u003e 1 then name || ' is one of ' || total || ' global trails.'\n    else name || ' is the only global trail.'\n  end as reason\n  \n  , t.region, t.account_id\nfrom\n  aws_cloudtrail_trail as t,\n  global_trails\nwhere\n  is_multi_region_trail\n  and region = home_region;\n",
  "Connector": "AWS",
  "PrimaryTable": "aws_cloudtrail_trail",
  "ListOfTables": [
    "aws_cloudtrail_trail"
  ]
}