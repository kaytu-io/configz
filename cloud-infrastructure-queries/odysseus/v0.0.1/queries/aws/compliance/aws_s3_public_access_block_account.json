{
  "ID": "aws_s3_public_access_block_account",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "select\n  'arn' || ':' || 'aws' || ':::' || account_id as resource,\n  case\n    when block_public_acls\n      and block_public_policy\n      and ignore_public_acls\n      and restrict_public_buckets\n      then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when block_public_acls\n      and block_public_policy\n      and ignore_public_acls\n      and restrict_public_buckets\n      then 'Account level public access blocks enabled.'\n    else 'Account level public access blocks not enabled for: ' ||\n      concat_ws(', ',\n        case when not (block_public_acls ) then 'block_public_acls' end,\n        case when not (block_public_policy) then 'block_public_policy' end,\n        case when not (ignore_public_acls ) then 'ignore_public_acls' end,\n        case when not (restrict_public_buckets) then 'restrict_public_buckets' end\n      ) || '.'\n  end as reason\n  , account_id\nfrom\n  aws_s3_account_settings;\n",
  "Connector": "AWS",
  "PrimaryTable": "aws_s3_account_settings",
  "ListOfTables": [
    "aws_s3_account_settings"
  ]
}