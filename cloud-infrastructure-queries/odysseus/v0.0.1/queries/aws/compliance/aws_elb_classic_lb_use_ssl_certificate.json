{
  "ID": "aws_elb_classic_lb_use_ssl_certificate",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "with detailed_classic_listeners as (\n  select\n    name\n  from\n    aws_ec2_classic_load_balancer,\n    jsonb_array_elements(listener_descriptions) as listener_description\n  where\n    listener_description -\u003e 'Listener' -\u003e\u003e 'Protocol' in ('HTTPS', 'SSL', 'TLS')\n    and listener_description -\u003e 'Listener' -\u003e\u003e 'SSLCertificateId' like 'arn:aws:acm%'\n)\nselect\n  'arn:' || a.partition || ':elasticloadbalancing:' || a.region || ':' || a.account_id || ':loadbalancer/' || a.name as resource,\n  case\n    when a.listener_descriptions is null then 'skip'\n    when b.name is not null then 'alarm'\n    else 'ok'\n  end as status,\n  case\n    when a.listener_descriptions is null then a.title || ' has no listener.'\n    when b.name is not null then a.title || ' does not use certificates provided by ACM.'\n    else a.title || ' uses certificates provided by ACM.'\n  end as reason\n  \n  , region, account_id\nfrom\n  aws_ec2_classic_load_balancer as a\n  left join detailed_classic_listeners as b on a.name = b.name;\n",
  "Connector": "AWS",
  "PrimaryTable": "aws_ec2_classic_load_balancer",
  "ListOfTables": [
    "aws_ec2_classic_load_balancer"
  ]
}