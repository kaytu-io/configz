{
  "ID": "aws_iam_group_user_role_no_inline_policies",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "select\n  arn as resource,\n  case\n    when inline_policies is null then 'ok'\n    else 'alarm'\n  end status,\n  'User ' || title || ' has ' || coalesce(jsonb_array_length(inline_policies), 0) || ' inline policies.' as reason\n  , account_id\nfrom\n  aws_iam_user\nunion\nselect\n  arn as resource,\n  case\n    when inline_policies is null then 'ok'\n    else 'alarm'\n  end status,\n  'Role ' || title || ' has ' || coalesce(jsonb_array_length(inline_policies), 0) || ' inline policies.' as reason\n  , account_id\nfrom\n  aws_iam_role\nwhere\n  arn not like '%service-role/%'\nunion\nselect\n  arn as resource,\n  case\n    when inline_policies is null then 'ok'\n    else 'alarm'\n  end status,\n  'Group ' || title || ' has ' || coalesce(jsonb_array_length(inline_policies), 0) || ' inline policies.' as reason\n  , account_id\nfrom\n  aws_iam_group;\n",
  "Connector": "AWS",
  "ListOfTables": [
    "aws_iam_group",
    "aws_iam_role",
    "aws_iam_user"
  ]
}