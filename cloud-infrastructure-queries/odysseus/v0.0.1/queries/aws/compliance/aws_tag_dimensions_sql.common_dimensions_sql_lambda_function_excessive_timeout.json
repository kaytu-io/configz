{
  "ID": "aws_tag_dimensions_sql.common_dimensions_sql_lambda_function_excessive_timeout",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "with lambda_duration as (\n  select\n    name,\n    avg(average:: numeric) as avg_duration\n  from\n    aws_lambda_function_metric_duration_daily\n  where\n    date_part('day', now() - timestamp) \u003c=7\n  group by\n    name\n)\nselect\n  arn as resource,\n  case\n    when avg_duration is null then 'error'\n    when ((timeout :: numeric*1000) - avg_duration)/(timeout :: numeric*1000) \u003e 0.1 then 'alarm'\n    else 'ok'\n  end as status,\n  case\n    when avg_duration is null then 'CloudWatch lambda metrics not available for ' || title || '.'\n    else title || ' Timeout of ' || timeout::numeric*1000 || ' milliseconds is ' || round(((timeout :: numeric*1000)-avg_duration)/(timeout :: numeric*1000)*100,1) || '% more as compared to average of ' || round(avg_duration,0) || ' milliseconds.'\n  end as reason\n    \n    , region, account_id\nfrom\n  aws_lambda_function f\n  left join lambda_duration as d on f.name = d.name;\n",
  "Connector": "AWS",
  "PrimaryTable": "aws_lambda_function",
  "ListOfTables": [
    "aws_lambda_function",
    "aws_lambda_function_metric_duration_daily"
  ]
}