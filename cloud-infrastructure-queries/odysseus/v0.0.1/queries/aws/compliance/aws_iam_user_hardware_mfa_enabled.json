{
  "ID": "aws_iam_user_hardware_mfa_enabled",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "select\n  u.arn as resource,\n  case\n    when serial_number is null then 'alarm'\n    when serial_number like any(array['%mfa%','%sms-mfa%']) then 'info'\n    else 'ok'\n  end as status,\n  case\n    when serial_number is null then u.name || ' MFA device not configured.'\n    when serial_number like any(array['%mfa%','%sms-mfa%']) then u.name || ' MFA enabled, but the MFA associated is a virtual device.'\n    else u.name || ' hardware MFA device enabled.'\n  end as reason\n  \n  , u.region, u.account_id\nfrom\n  aws_iam_virtual_mfa_device as m\n  right join aws_iam_user as u on m.user_id = u.user_id;\n",
  "Connector": "AWS",
  "PrimaryTable": "aws_iam_virtual_mfa_device",
  "ListOfTables": [
    "aws_iam_user",
    "aws_iam_virtual_mfa_device"
  ]
}