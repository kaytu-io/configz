{
  "ID": "aws_aws_iam_user_group_role_cloudshell_fullaccess_restricted",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "select\n  arn as resource,\n  case\n    when attached_policy_arns @\u003e '[\"arn:aws:iam::aws:policy/AWSCloudShellFullAccess\"]' then 'alarm'\n    else 'ok'\n  end status,\n  case\n    when attached_policy_arns @\u003e '[\"arn:aws:iam::aws:policy/AWSCloudShellFullAccess\"]' then  'User ' || title || ' has access to AWSCloudShellFullAccess.'\n    else 'User ' || title || ' access to AWSCloudShellFullAccess is restricted.'\n  end as reason\n  , account_id\nfrom\n  aws_iam_user\nunion\nselect\n  arn as resource,\n  case\n    when attached_policy_arns @\u003e '[\"arn:aws:iam::aws:policy/AWSCloudShellFullAccess\"]' then 'alarm'\n    else 'ok'\n  end status,\n  case\n    when attached_policy_arns @\u003e '[\"arn:aws:iam::aws:policy/AWSCloudShellFullAccess\"]' then  'Role ' || title || ' has access to AWSCloudShellFullAccess.'\n    else 'Role ' || title || ' access to AWSCloudShellFullAccess is restricted.'\n  end as reason\n  , account_id\nfrom\n  aws_iam_role\nunion\nselect\n  arn as resource,\n  case\n    when attached_policy_arns @\u003e '[\"arn:aws:iam::aws:policy/AWSCloudShellFullAccess\"]' then 'alarm'\n    else 'ok'\n  end status,\n  case\n    when attached_policy_arns @\u003e '[\"arn:aws:iam::aws:policy/AWSCloudShellFullAccess\"]' then  'Group ' || title || ' has access to AWSCloudShellFullAccess.'\n    else 'Group ' || title || ' access to AWSCloudShellFullAccess is restricted.'\n  end as reason\n  , account_id\nfrom\n  aws_iam_group;\n",
  "Connector": "AWS",
  "ListOfTables": [
    "aws_iam_user",
    "aws_iam_role",
    "aws_iam_group"
  ]
}