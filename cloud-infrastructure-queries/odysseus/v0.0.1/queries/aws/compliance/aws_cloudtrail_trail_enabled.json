{
  "ID": "aws_cloudtrail_trail_enabled",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "with trails_enabled as (\n  select\n    arn,\n    is_logging\n  from\n    aws_cloudtrail_trail\n  where\n    home_region = region\n)\nselect\n  a.arn as resource,\n  case\n    when b.is_logging is null and a.is_logging then 'ok'\n    when b.is_logging then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when b.is_logging is null and a.is_logging then a.title || ' enabled.'\n    when b.is_logging then a.title || ' enabled.'\n    else a.title || ' disabled.'\n  end as reason\n  \n  , a.region, a.account_id\nfrom\n  aws_cloudtrail_trail as a\nleft join trails_enabled b on a.arn = b.arn;\n",
  "Connector": "AWS",
  "PrimaryTable": "aws_cloudtrail_trail",
  "ListOfTables": [
    "aws_cloudtrail_trail"
  ]
}