{
  "ID": "aws_elb_application_lb_listener_certificate_expire_30_days",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "select\n  load_balancer_arn as resource,\n  case\n    when date(not_after) - date(current_date) \u003e= 30 then 'ok'\n    else 'alarm'\n  end as status,\n  l.title || ' certificate set to expire in ' || extract(day from not_after - current_date) || ' days.' as reason\n  , l.region, l.account_id\nfrom\n  aws_ec2_load_balancer_listener as l,\n  jsonb_array_elements(certificates) as c\n  left join aws_acm_certificate as a on c -\u003e\u003e 'CertificateArn' = a.certificate_arn;\n",
  "Connector": "AWS",
  "PrimaryTable": "aws_ec2_load_balancer_listener",
  "ListOfTables": [
    "aws_acm_certificate",
    "aws_ec2_load_balancer_listener"
  ]
}