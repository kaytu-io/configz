{
  "ID": "aws_rds_db_instance_and_cluster_no_default_port",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "(\nselect\n  arn as resource,\n  case\n      when engine similar to '%(aurora|mysql|mariadb)%' and port = '3306' then 'alarm'\n      when engine like '%postgres%' and port = '5432' then 'alarm'\n      when engine like 'oracle%' and port = '1521' then 'alarm'\n      when engine like 'sqlserver%' and port = '1433' then 'alarm'\n    else 'ok'\n  end as status,\n  case\n      when engine similar to '%(aurora|mysql|mariadb)%' and port = '3306' then  title || ' ' ||  engine || ' uses a default port.'\n      when engine like '%postgres%' and port = '5432' then  title || ' ' ||  engine || ' uses a default port.'\n      when engine like 'oracle%' and port = '1521' then  title || ' ' ||  engine || ' uses a default port.'\n      when engine like 'sqlserver%' and port = '1433' then  title || ' ' ||  engine || ' uses a default port.'\n    else title || ' doesnt use a default port.'\n  end as reason\n  \n  , region, account_id\nfrom\n  aws_rds_db_cluster\n)\nunion\n(\nselect\n  arn as resource,\n  case\n      when engine similar to '%(aurora|mysql|mariadb)%' and port = '3306' then 'alarm'\n      when engine like '%postgres%' and port = '5432' then 'alarm'\n      when engine like 'oracle%' and port = '1521' then 'alarm'\n      when engine like 'sqlserver%' and port = '1433' then 'alarm'\n    else 'ok'\n  end as status,\n  case\n      when engine similar to '%(aurora|mysql|mariadb)%' and port = '3306' then  title || ' ' ||  engine || ' uses a default port.'\n      when engine like '%postgres%' and port = '5432' then  title || ' ' ||  engine || ' uses a default port.'\n      when engine like 'oracle%' and port = '1521' then  title || ' ' ||  engine || ' uses a default port.'\n      when engine like 'sqlserver%' and port = '1433' then  title || ' ' ||  engine || ' uses a default port.'\n    else title || ' doesnt use a default port.'\n  end as reason\n  \n  , region, account_id\nfrom\n  aws_rds_db_instance\n);\n",
  "Connector": "AWS",
  "ListOfTables": [
    "aws_rds_db_cluster",
    "aws_rds_db_instance"
  ]
}