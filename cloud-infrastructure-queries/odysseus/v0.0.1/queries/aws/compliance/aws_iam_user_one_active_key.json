{
  "ID": "aws_iam_user_one_active_key",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "select\n  u.arn as resource,\n  case\n    when count(k.*) \u003e 1 then 'alarm'\n    else 'ok'\n  end as status,\n  u.name || ' has ' || count(k.*) || ' active access key(s).' as reason\n  \n  , u.account_id\nfrom\n  aws_iam_user as u\n  left join aws_iam_access_key as k on u.name = k.user_name and u.account_id = k.account_id\nwhere\n  k.status = 'Active' or k.status is null\ngroup by\n  u.arn,\n  u.name,\n  u.account_id,\n  u.tags,\n  u._ctx;\n",
  "Connector": "AWS",
  "PrimaryTable": "aws_iam_user",
  "ListOfTables": [
    "aws_iam_access_key",
    "aws_iam_user"
  ]
}