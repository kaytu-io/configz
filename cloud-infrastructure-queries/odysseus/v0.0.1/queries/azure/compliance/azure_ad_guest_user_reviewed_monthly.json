{
  "ID": "azure_ad_guest_user_reviewed_monthly",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "select\n  u.display_name as resource,\n  case\n    when not account_enabled then 'alarm'\n    when u.created_date_time::timestamp \u003c= (current_date - interval '30' day) then 'alarm'\n    else 'ok'\n  end as status,\n  case\n    when not account_enabled then 'Guest user ''' || u.display_name || ''' inactive.'\n    else 'Guest user ''' || u.display_name || ''' was created ' || extract(day from current_timestamp - u.created_date_time::timestamp) || ' days ago.'\n  end as reason,\n  t.tenant_id\n  \nfrom\n  azuread_user as u\n  left join azure_tenant as t on t.tenant_id = u.tenant_id\nwhere\n  u.user_type = 'Guest';\n",
  "Connector": "Azure",
  "PrimaryTable": "azuread_user",
  "ListOfTables": [
    "azure_tenant",
    "azuread_user",
    "azure_tenant",
    "azuread_user"
  ]
}