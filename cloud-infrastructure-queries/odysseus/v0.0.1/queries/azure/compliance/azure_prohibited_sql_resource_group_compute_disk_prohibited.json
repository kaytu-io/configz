{
  "ID": "azure_prohibited_sql_resource_group_compute_disk_prohibited",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "with analysis as (\n  select\n    id,\n    array_agg(k) as prohibited_tags\n  from\n    azure_compute_disk,\n    jsonb_object_keys(tags) as k,\n    unnest($1::text[]) as prohibited_key\n  where\n    k = prohibited_key\n  group by\n    id\n)\nselect\n  r.id as resource,\n  case\n    when a.prohibited_tags \u003c\u003e array[]::text[] then 'alarm'\n    else 'ok'\n  end as status,\n  case\n    when a.prohibited_tags \u003c\u003e array[]::text[] then r.title || ' has prohibited tags: ' || array_to_string(a.prohibited_tags, ', ') || '.'\n    else r.title || ' has no prohibited tags.'\n  end as reason,\n  r.resource_group, r.subscription_id\nfrom\n  azure_compute_disk as r\nfull outer join\n  analysis as a on a.id = r.id\n",
  "Connector": "Azure",
  "PrimaryTable": "azure_compute_disk",
  "ListOfTables": [
    "azure_compute_disk"
  ]
}