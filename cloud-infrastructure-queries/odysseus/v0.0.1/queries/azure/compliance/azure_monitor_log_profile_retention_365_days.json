{
  "ID": "azure_monitor_log_profile_retention_365_days",
  "Engine": "odysseus-v0.0.1",
  "QueryToExecute": "select\n  p.id as resource,\n  case\n    when p.retention_policy -\u003e\u003e 'enabled' = 'false' then 'alarm'\n    when p.retention_policy -\u003e\u003e 'enabled' = 'true' and (p.retention_policy -\u003e\u003e 'days')::int \u003e= 365 then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when p.retention_policy -\u003e\u003e 'enabled' = 'false' then p.name || ' retention policy disabled.'\n    else p.name || ' retention is set to ' || (p.retention_policy -\u003e\u003e 'days') || ' day(s).'\n  end as reason\n  \n  , p.resource_group as resource_group\n  , sub.display_name as subscription\nfrom\n  azure_log_profile as p\n  left join azure_subscription sub on sub.subscription_id = p.subscription_id;\n",
  "Connector": "Azure",
  "PrimaryTable": "azure_log_profile",
  "ListOfTables": [
    "azure_log_profile",
    "azure_subscription"
  ]
}