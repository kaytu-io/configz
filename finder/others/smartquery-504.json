{
  "connectors": ["Azure"],
  "title": "List of all keys where expiration date is not set",
  "query": "select\n  -- Required Columns\n  kvk.id as resource,\n  case\n    when enabled and expires_at is null then 'alarm'\n    else 'ok'\n  end as status,\n  vault_name || ' key ' || name ||\n    case\n      when enabled and expires_at is null then ' expiration date not set.'\n      when not enabled then ' disabled.'\n      else 'expiration date set to ' || to_char(expires_at, 'DD-Mon-YYYY') || '.'\n  end as reason,\n  -- Additional Dimensions\n  resource_group,\n  sub.display_name as subscription\nfrom\n  azure_key_vault_key kvk,\n  azure_subscription sub\nwhere\n  sub.subscription_id = kvk.subscription_id"
}