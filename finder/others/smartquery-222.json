{
  "connectors": ["AWS"],
  "title": "Find all VPCs not restricting all traffic on default security groups",
  "query": "select\n  -- Required Columns\n  arn resource,\n  case\n    when ip_permissions is null and ip_permissions_egress is null then 'ok'\n    else 'alarm'\n  end status,\n  case\n    when ip_permissions is not null and ip_permissions_egress is not null\n      then 'Default security group ' || group_id || ' has inbound and outbound rules.'\n    when ip_permissions is not null and ip_permissions_egress is null\n      then 'Default security group ' || group_id || ' has inbound rules.'\n    when ip_permissions is null and ip_permissions_egress is not null\n      then 'Default security group ' || group_id || ' has outbound rules.'\n    else 'Default security group ' || group_id || ' has no inbound or outbound rules.'\n  end reason,\n  -- Additional Dimensions\n  region,\n  account_id\nfrom\n  aws_vpc_security_group\nwhere\n  group_name = 'default'"
}