{
  "connectors": ["Azure"],
  "title": "Get list of Storage accounts where 'Secure transfer required' is not set to 'Enabled'",
  "query": "select\n  -- Required Columns\n  sa.id as resource,\n  case\n    when not enable_https_traffic_only then 'alarm'\n    else 'ok'\n  end as status,\n  case\n    when not enable_https_traffic_only then sa.name || ' encryption in transit not enabled.'\n    else sa.name || ' encryption in transit enabled.'\n  end as reason,\n  -- Additional Dimensions\n  resource_group,\n  sub.display_name as subscription\nfrom\n  azure_storage_account sa,\n  azure_subscription sub\nwhere\n  sub.subscription_id = sa.subscription_id"
}