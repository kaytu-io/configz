Connector: AWS
Description: AWS Account with more than 1 SAML provider
Enabled: true
ID: 44.0
Internal: false
Links: null
LogoURL: ""
LongTitle: AWS Account with many SAML providers
Query:
  Connector: AWS
  Engine: odysseus-v0.0.1
  ID: aws_insight_account_with_many_saml_providers
  ListOfTables:
  - aws_iam_credential_report
  PrimaryTable: aws_iam_credential_report
  QueryToExecute: |-
    SELECT account_id, kaytu_account_id, CAST(SUM(saml_provider_count) AS INTEGER) AS saml_provider_count FROM (
      SELECT account_id, kaytu_account_id, COUNT(*) as saml_provider_count FROM aws_iam_saml_provider GROUP BY account_id, kaytu_account_id
      UNION
      SELECT account_id, kaytu_account_id, COUNT(*) as saml_provider_count FROM aws_iam_open_id_connect_provider GROUP BY account_id, kaytu_account_id
    ) AS final WHERE saml_provider_count > 1 GROUP BY account_id, kaytu_account_id
ShortTitle: AWS Account with many SAML providers
Tags:
  category:
  - Security
  persona:
  - DevOps
  - Security
  - Executive
  - Product
