Description: Password policies, in part, enforce password complexity requirements. Use IAM password policies to ensure that passwords are at least a given length. Security Hub recommends that the password policy require a minimum password length of 14 characters.
DocumentURI: ""
ID: aws_iam_account_password_policy_min_length_14
Managed: true
ManualVerification: false
Query:
  Connector: AWS
  Engine: odysseus-v0.0.1
  ListOfTables:
  - aws_account
  - aws_iam_account_password_policy
  PrimaryTable: aws_account
  QueryToExecute: |
    select
      'arn:' || a.partition || ':::' || a.account_id as resource,
      a.kaytu_account_id as kaytu_account_id,
      a.kaytu_resource_id as kaytu_resource_id,
      case
        when minimum_password_length >= 14 then 'ok'
        else 'alarm'
      end as status,
      case
        when minimum_password_length is null then 'No password policy set.'
        else 'Minimum password length set to ' || minimum_password_length || '.'
      end as reason
      , a.account_id
    from
      aws_account as a
      left join aws_iam_account_password_policy as pol on a.account_id = pol.account_id;
Severity: high
Tags:
  category:
  - Compliance
  cis_controls_v8_ig1:
  - "true"
  fedramp_low_rev_4:
  - "true"
  fedramp_moderate_rev_4:
  - "true"
  gdpr:
  - "true"
  nist_800_53_rev_5:
  - "true"
  plugin:
  - aws
  service:
  - AWS/IAM
  x-kaytu-explanation:
  - "# Password Policies in AWS\n\nAWS Identity and Access Management (IAM) offers functionalities to specify and enforce password policies and thereby maintain robust security in your AWS resources. A crucial part of these password policies involves setting password complexity requirements.\n\n## IAM Password Policies \n\nIAM password policy plays a pivotal role in ensuring the security and integrity of your passwords. You can configure IAM password policy to demand a minimum password length.\n\n### Recommendation\n\nAWS Security Hub recommends adopting a password policy that necessitates a **minimum password length of 14 characters**. Ensuring your passwords have a minimum length of 14 characters drastically enhances the difficulty of unauthorized access through brute force attacks.\n\nExamples:\n\n```markdown\n- At least 14 characters in length\n- Comprises of both uppercase and lowercase letters\n- Incorporates numbers and special characters\n```\n\nThrough implementing a robust password policy, you enhance the security posture of your AWS infrastructure and make it less vulnerable to potential attacks."
  x-kaytu-noncompliance-cost:
  - |-
    Non-compliance to the AWS security control of password policy, specifically of having a minimum of 14 characters, might lead to the following costs:

    1. **Financial Loss:** If a potential attacker successfully penetrates the system due to a weak password, they might gain unauthorized access to valuable data or resources that can lead to financial loss.

    2. **Reputation Damage:** A security breach can seriously damage a company's reputation, leading to loss of customers or clients.

    3. **Regulation Fines & Legal Action:** If the breach results in compromise of personal data, companies may face hefty fines from regulatory bodies for not adhering to data protection laws, as well as potential lawsuits.

    4. **Breach Mitigation Costs:** Post-breach activities such as investigations, mitigation actions, reparations, and bolstering security infrastructure can be costly.

    To summarize, using IAM password policy is a fundamental preventive control designed to reduce the likelihood of accidental or deliberate unauthorized access. Non-compliance with this control could result in potential exposure of sensitive data and significant subsequent costs.
  x-kaytu-usefulness-example:
  - "The AWS Identity and Access Management (IAM) service includes an option for administrators to set password policies for users in an organization. The security benefit of having a password policy deployed in IAM is that it adds an additional layer of protection to the AWS resources and ensures that only authorized users have access to the specific datasets.\n\n```markdown\n### Example Instance:\n\nImagine working in a large enterprise that leverages the services of AWS. There are a number of AWS users in the organization enterprise, accessing numerous AWS resources. To ensure that only authorized employees access certain datasets and resources, you decide to deploy password policies.\n\nYou can leverage IAM feature to set a password policy in the AWS Management Console. The password policy can include password complexity requirements like passwords containing uppercase letters, lowercase letters, numbers, and special characters. Moreover, you can also define the minimum password length.\n\nIn accordance with Security Hub's recommendations, you might set the password policy to require a minimum password length of 14 characters. Thus, every time a user creates a new password or changes existing one, they must adhere to this policy. \n\nThis scenario can be crucial for maintaining access controls to prevent any unauthorized access or data breaches. Moreover, it can ensure that even if one of the user accounts is compromised, the complexity and length requirements would make it less likely for the hacker to break into the system, thus, providing enhanced security.\n```"
Title: Ensure IAM password policy requires a minimum length of 14 or greater
