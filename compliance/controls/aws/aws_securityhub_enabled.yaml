Description: AWS Security Hub helps to monitor unauthorized personnel, connections, devices, and software. AWS Security Hub aggregates, organizes, and prioritizes the security alerts, or findings, from multiple AWS services.
DocumentURI: ""
ID: aws_securityhub_enabled
Managed: true
ManualVerification: false
Query:
  Connector: AWS
  Engine: odysseus-v0.0.1
  ListOfTables:
  - aws_region
  - aws_securityhub_hub
  PrimaryTable: aws_region
  QueryToExecute: |
    select
      'arn:' || r.partition || '::' || r.region || ':' || r.account_id as resource,
      r.kaytu_account_id as kaytu_account_id,
      r.kaytu_resource_id as kaytu_resource_id,
      case
        when r.region = any(array['af-south-1', 'eu-south-1', 'cn-north-1', 'cn-northwest-1', 'ap-northeast-3']) then 'skip'
        -- Skip any regions that are disabled in the account.
        when r.opt_in_status = 'not-opted-in' then 'skip'
        when h.hub_arn is not null then 'ok'
        else 'alarm'
      end as status,
      case
        when r.region = any(array['af-south-1', 'eu-south-1', 'cn-north-1', 'cn-northwest-1', 'ap-northeast-3']) then r.region ||  ' region not supported.'
        when r.opt_in_status = 'not-opted-in' then r.region || ' region is disabled.'
        when h.hub_arn is not null then 'Security Hub enabled in ' || r.region || '.'
        else 'Security Hub disabled in ' || r.region || '.'
      end as reason
      , r.region, r.account_id
    from
      aws_region as r
      left join aws_securityhub_hub as h on r.account_id = h.account_id and r.name = h.region;
Severity: low
Tags:
  category:
  - Compliance
  cis_controls_v8_ig1:
  - "true"
  cisa_cyber_essentials:
  - "true"
  fedramp_low_rev_4:
  - "true"
  fedramp_moderate_rev_4:
  - "true"
  ffiec:
  - "true"
  gxp_21_cfr_part_11:
  - "true"
  gxp_eu_annex_11:
  - "true"
  hipaa_final_omnibus_security_rule_2013:
  - "true"
  hipaa_security_rule_2003:
  - "true"
  nist_800_171_rev_2:
  - "true"
  nist_800_53_rev_4:
  - "true"
  nist_800_53_rev_5:
  - "true"
  nist_csf:
  - "true"
  plugin:
  - aws
  rbi_cyber_security:
  - "true"
  service:
  - AWS/SecurityHub
  soc_2:
  - "true"
  x-kaytu-explanation:
  - `AWS Security Hub` is a powerful tool that assists in the ongoing observation of unauthorized individuals, connections, devices, and software within an AWS environment. By aggregating, sorting, and prioritizing security alerts (also known as "findings"), it serves as a holistic dashboard to manage potential threats across multiple AWS services concurrently. This helps to simplify the process of managing numerous alerts and streamlining response efforts, enhancing the overall security of your AWS infrastructure.
  x-kaytu-noncompliance-cost:
  - "The cost of non-compliance to the AWS Security Hub control can be significant, and can manifest in several ways. \n\n1. Financial Costs: Non-compliance can lead to financial penalties imposed by industry regulations and standards, such as the GDPR, HIPAA, or PCI DSS. Furthermore, if a data breach occurs as a result of non-compliance, the cost to recover from the breach can also be substantial.\n\n2. Damage to Brand and Reputation: If the non-compliance leads to a security incident, such as data breaches, it can cause significant damage to an organization's brand and reputation. In today's world where data security is paramount, such damage can be long-lasting and can lead to loss of customers or clients.\n\n3. Legal Consequences: Non-compliance can also result in legal consequences, including lawsuits, if the organization failed to meet its obligations to protect customer or client data.\n\n4. Disruption to Business Operations: Non-compliance can lead to disruption in normal business operations in the event of a security incident. This could be due to the time required to respond and recover from the incident, or it could be due to sanctions imposed by regulatory bodies that restrict the organization's ability to operate until it can demonstrate compliance.\n\n5. Increased Oversight and Future Compliance Costs: If an organization is found to be non-compliant, it may face increased oversight from regulatory bodies and could be required to invest more in future compliance efforts. \n\nTo stay compliant, it's crucial to utilize services and tools like AWS Security Hub that help in aligning with industry standards and regulations, detecting potential threats, and managing security risks on time."
  x-kaytu-usefulness-example:
  - |-
    For instance, a large tech company that makes use of several AWS services ranging from EC2 instances to S3 buckets for their daily operations. Given the vast scale of their cloud architecture, they may have multiple security operations and monitoring services such as GuardDuty, Inspector and Macie running simultaneously.

    Without a unified platform to aggregate and analyze the findings from these varied security services, the company's security analysts might get overwhelmed trying to sieve through a multitude of data points, potentially missing out on a critical vulnerability or ongoing breach.

    By utilizing AWS Security Hub, the analysts can have all of these findings aggregated, organized, and prioritized in a single dashboard. This can greatly streamline their cybersecurity efforts and improve their response time to imminent threats. Furthermore, the automated insights provided by AWS Security Hub can help them identify and address recurring trends in their system's security posture. 

    Thus, Security Hub proves to be a highly beneficial tool in improving the organization's overall cloud security framework.
Title: AWS Security Hub should be enabled for an AWS Account
