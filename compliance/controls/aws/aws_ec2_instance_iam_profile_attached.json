{
  "ID": "aws_ec2_instance_iam_profile_attached",
  "Title": "EC2 instances should have IAM profile attached",
  "Description": "Ensure if an Amazon Elastic Compute Cloud (Amazon EC2) instance has an Identity and Access Management (IAM) profile attached to it. This rule is non compliant if no IAM profile is attached to the Amazon EC2 instance.",
  "Query": {
    "Engine": "odysseus-v0.0.1",
    "QueryToExecute": "select\n  arn as resource,\n  case\n    when iam_instance_profile_id is not null then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when iam_instance_profile_id is not null then title || ' IAM profile attached.'\n    else title || ' IAM profile not attached.'\n  end as reason\n  \n  , region, account_id\nfrom\n  aws_ec2_instance;\n",
    "Connector": "AWS",
    "PrimaryTable": "aws_ec2_instance",
    "ListOfTables": [
      "aws_ec2_instance"
    ]
  },
  "ManualVerification": false,
  "Severity": "",
  "Tags": {
    "category": [
      "Compliance"
    ],
    "cis_controls_v8_ig1": [
      "true"
    ],
    "ffiec": [
      "true"
    ],
    "gxp_21_cfr_part_11": [
      "true"
    ],
    "hipaa_final_omnibus_security_rule_2013": [
      "true"
    ],
    "nist_800_171_rev_2": [
      "true"
    ],
    "nist_800_53_rev_5": [
      "true"
    ],
    "nist_csf": [
      "true"
    ],
    "plugin": [
      "aws"
    ],
    "service": [
      "AWS/EC2"
    ]
  },
  "Managed": true
}