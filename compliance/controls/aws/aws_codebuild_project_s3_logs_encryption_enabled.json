{
  "ID": "aws_codebuild_project_s3_logs_encryption_enabled",
  "Title": "CodeBuild S3 logs should be encrypted",
  "Description": "This control checks if Amazon S3 logs for an AWS CodeBuild project are encrypted. The control fails if encryption is deactivated for S3 logs for a CodeBuild project.",
  "Query": {
    "Engine": "odysseus-v0.0.1",
    "QueryToExecute": "select\n  arn as resource,\n  kaytu_account_id as kaytu_account_id,\n  kaytu_resource_id as kaytu_resource_id,\n  case\n    when not (logs_config -> 'S3Logs' ->> 'EncryptionDisabled')::bool then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when not (logs_config -> 'S3Logs' ->> 'EncryptionDisabled')::bool then title || ' S3Logs encryption enabled.'\n    else title || ' S3Logs encryption disabled.'\n  end as reason\n  \n  , region, account_id\nfrom\n  aws_codebuild_project;\n",
    "Connector": "AWS",
    "PrimaryTable": "aws_codebuild_project",
    "ListOfTables": [
      "aws_codebuild_project"
    ]
  },
  "ManualVerification": false,
  "Severity": "low",
  "Tags": {
    "aws_foundational_security": [
      "true"
    ],
    "category": [
      "Compliance"
    ],
    "foundational_security_category": [
      "encryption_of_data_at_rest"
    ],
    "foundational_security_item_id": [
      "codebuild_3"
    ],
    "plugin": [
      "aws"
    ],
    "service": [
      "AWS/CodeBuild"
    ]
  },
  "Managed": true
}