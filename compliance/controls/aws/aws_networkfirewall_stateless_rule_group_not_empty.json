{
  "ID": "aws_networkfirewall_stateless_rule_group_not_empty",
  "Title": "Stateless network firewall rule group should not be empty",
  "Description": "A rule group contains rules that define how your firewall processes traffic in your VPC. An empty stateless rule group when present in a firewall policy might give the impression that the rule group will process traffic. However, when the stateless rule group is empty, it does not process traffic.",
  "Query": {
    "Engine": "odysseus-v0.0.1",
    "QueryToExecute": "select\n  arn as resource,\n  case\n    when type = 'STATEFUL' then 'skip'\n    when jsonb_array_length(rules_source -\u003e 'StatelessRulesAndCustomActions' -\u003e 'StatelessRules') \u003e 0 then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when type = 'STATEFUL' then title || ' is a stateful rule group.'\n    else title || ' has ' || jsonb_array_length(rules_source -\u003e 'StatelessRulesAndCustomActions' -\u003e 'StatelessRules') || ' rule(s).'\n  end as reason\n  \n  , region, account_id\nfrom\n  aws_networkfirewall_rule_group;\n",
    "Connector": "AWS",
    "PrimaryTable": "aws_networkfirewall_rule_group",
    "ListOfTables": [
      "aws_networkfirewall_rule_group"
    ]
  },
  "ManualVerification": false,
  "Severity": "medium",
  "Tags": {
    "aws_foundational_security": [
      "true"
    ],
    "category": [
      "Compliance"
    ],
    "foundational_security_category": [
      "secure_network_configuration"
    ],
    "foundational_security_item_id": [
      "networkfirewall_1"
    ],
    "plugin": [
      "aws"
    ],
    "service": [
      "AWS/NetworkFirewall"
    ]
  },
  "Managed": true
}