Description: Manage access to resources in the AWS Cloud by ensuring MFA is enabled for the root user.
DocumentURI: ""
ID: aws_iam_root_user_mfa_enabled
Managed: true
ManualVerification: false
Query:
  Connector: AWS
  Engine: odysseus-v0.0.1
  ListOfTables:
  - aws_iam_account_summary
  PrimaryTable: aws_iam_account_summary
  QueryToExecute: |
    select
      'arn:' || partition || ':::' || account_id as resource,
      kaytu_account_id as kaytu_account_id,
      kaytu_resource_id as kaytu_resource_id,
      case
        when account_mfa_enabled then 'ok'
        else 'alarm'
      end status,
      case
        when account_mfa_enabled then 'MFA enabled for root account.'
        else 'MFA not enabled for root account.'
      end reason
      , account_id
    from
      aws_iam_account_summary;
Severity: critical
Tags:
  audit_manager_control_tower:
  - "true"
  category:
  - Compliance
  cis_controls_v8_ig1:
  - "true"
  cisa_cyber_essentials:
  - "true"
  fedramp_low_rev_4:
  - "true"
  fedramp_moderate_rev_4:
  - "true"
  ffiec:
  - "true"
  gdpr:
  - "true"
  gxp_21_cfr_part_11:
  - "true"
  hipaa_final_omnibus_security_rule_2013:
  - "true"
  hipaa_security_rule_2003:
  - "true"
  nist_800_171_rev_2:
  - "true"
  nist_800_53_rev_4:
  - "true"
  nist_800_53_rev_5:
  - "true"
  nist_csf:
  - "true"
  plugin:
  - aws
  service:
  - AWS/IAM
  soc_2:
  - "true"
  x-kaytu-explanation:
  - "# AWS Control: Enabling MFA for Root User\n\nManaging security should be the primary concern when dealing with cloud resources. One of the vital control in AWS is enabling Multi-Factor Authentication (MFA) for the root user. \n\n## What is MFA this AWS Control about?\n\nMulti-Factor Authentication (MFA) adds an extra layer of protection to the AWS root user account. In addition to the regular username and password, MFA requires users to verify their identities with a second form of authentication. It could be through a text message, phone call or MFA hardware device. \n\nWith MFA enabled, even if an attacker acquires your password, they won't be able to access your roots user account without the second form of authentication, providing a significant increase in account security.\n\n## Where is it used?\n\nThis control is mainly used in the AWS Identity and Access Management (IAM) service to manage access to AWS resources.\n\n## Why is it important?\n\n- It provides greater security for your AWS resources.\n- It lowers the risk of unauthorized access or breaches.\n- It helps meet compliance requirements for strong authentication.\n\n## How to implement it?\n\nHere is a simplified outline on how you could enable MFA for the root user in AWS IAM:\n\n1. Open the AWS Management Console and sign in as the root user.\n2. Go to the **IAM dashboard** in the AWS Management Console.\n3. In the **Security Status** section, choose **Activate MFA on your root account**.\n4. In the **Manage MFA** wizard, choose which type of MFA device you want to use (virtual or hardware), then follow the on-screen instructions.\n5. After setting up the MFA device, return to the **IAM dashboard**. The security status for MFA should now show as enabled.\n\nRemember, it's recommended to use MFA not only for the root user, but for all IAM users in your account. \n\nIt is also a best practice to avoid using the root user for everyday tasks, and to instead create individual IAM users with appropriate permissions for day-to-day operations. \n\nEnsure systematic application of this control to keep your AWS resources safe and secure."
  x-kaytu-noncompliance-cost:
  - |-
    Non-compliance with this AWS control, "Manage access to resources in the AWS Cloud by ensuring Multi-Factor Authentication (MFA) is enabled for the root user", can result in several potential costs and risks, as detailed below:

    1. **Increased Security risks:** By not enabling MFA, you invite an increased risk of unauthorized access to your AWS resources. If an attacker gains unauthorized access to the root user account, they could have unfettered and irreversible access to your services and data.

    2. **Financial loss:** Attackers who gain access to your AWS Cloud can cause substantial financial loss. They could misuse resources, create large instances, transfer large amounts of data, or even delete crucial resources, leading to significant added costs or loss of revenue.

    3. **Violation of Compliance Requirements:** If your organization is subject to regulatory obligations that require MFA (such as PCI-DSS, GDPR, and others), non-compliance could lead to fines or penalties.

    4. **Loss of customer trust:** In the event of a data breach resulting from non-compliance with this AWS control, the reputation damage to your business could lead to loss of customer trust and potential loss of business in the future.

    5. **Data Loss:** If an unauthorized user gains access to your AWS account, there is a high risk of data loss. This can happen through either malicious intent (deleting data) or accidental mismanagement.

    Therefore, it is highly recommended to enable MFA for the root user to reduce the risk of unauthorized access.
  x-kaytu-usefulness-example:
  - "As an IT administrator, you are constantly looking out for ways to protect sensitive company data stored in the AWS Cloud. One day, your company suffers a data breach and the root user credentials are compromised. Luckily, you have the Multi-Factor Authentication (MFA) enabled for the root user, preventing the attackers from gaining full access to your resources.\n\nHere is an example of how this control could be setup in AWS IAM:\n\n```markup\n1. Sign in to the AWS Management Console and open the IAM console at https://console.aws.amazon.com/iam/.\n2. Choose \"Users\" in the navigation pane.\n3. Choose the name of the intended user.\n4. In the \"Security credentials\" tab, navigate to the \"Assigned MFA device\" section.\n5. Choose \"Manage\" to open the Manage MFA wizard.\n6. Choose a compatible MFA device for the user. \n7. Follow the steps to activate MFA for the user account.\n\nNote: Remember to regularly review the users with MFA enabled and enforce this policy to all critical users.\n```\n\nBy enabling MFA for the root user, you add an extra layer of security to your AWS resources as the attacker would need not only the user's password, but also access to their MFA device. This significantly reduces the probability of unauthorized access and the potential damage that could be done to your AWS resources. This is a key measure in helping your company prevent costly and damaging data breaches."
Title: IAM root user MFA should be enabled
