{
  "ID": "aws_iam_access_analyzer_enabled",
  "Title": "Ensure that IAM Access analyzer is enabled",
  "Description": "Enable IAM Access analyzer for IAM policies about all resources. IAM Access Analyzer is a technology introduced at AWS reinvent 2019. After the Analyzer is enabled in IAM, scan results are displayed on the console showing the accessible resources. Scans show resources that other accounts and federated users can access, such as KMS keys and IAM roles. So the results allow you to determine if an unintended user is allowed, making it easier for administrators to monitor least privileges access.",
  "Query": {
    "Engine": "odysseus-v0.0.1",
    "QueryToExecute": "select\n  'arn:' || r.partition || '::' || r.region || ':' || r.account_id as resource,\n  case\n    -- Skip any regions that are disabled in the account.\n    when r.opt_in_status = 'not-opted-in' then 'skip'\n    when aa.arn is not null then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when r.opt_in_status = 'not-opted-in' then r.region || ' region is disabled.'\n    when aa.arn is not null then aa.name ||  ' enabled in ' || r.region || '.'\n    else 'Access Analyzer not enabled in ' || r.region || '.'\n  end as reason\n  , r.region, r.account_id\nfrom\n  aws_region as r\n  left join aws_accessanalyzer_analyzer as aa on r.account_id = aa.account_id and r.region = aa.region;\n",
    "Connector": "AWS",
    "PrimaryTable": "aws_region",
    "ListOfTables": [
      "aws_accessanalyzer_analyzer",
      "aws_region"
    ]
  },
  "ManualVerification": false,
  "Severity": "",
  "Tags": {
    "category": [
      "Compliance"
    ],
    "cis": [
      "true"
    ],
    "cis_item_id": [
      "1.21"
    ],
    "cis_level": [
      "1"
    ],
    "cis_section_id": [
      "1"
    ],
    "cis_type": [
      "automated"
    ],
    "cis_version": [
      "v1.3.0"
    ],
    "plugin": [
      "aws"
    ],
    "service": [
      "AWS/IAM"
    ]
  },
  "Managed": true
}