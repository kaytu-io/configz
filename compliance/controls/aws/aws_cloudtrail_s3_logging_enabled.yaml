Description: S3 Bucket Access Logging generates a log that contains access records for each request made to your S3 bucket. An access log record contains details about the request, such as the request type, the resources specified in the request worked, and the time and date the request was processed. It is recommended that bucket access logging be enabled on the CloudTrail S3 bucket.
DocumentURI: ""
ID: aws_cloudtrail_s3_logging_enabled
Managed: true
ManualVerification: false
Query:
  Connector: AWS
  Engine: odysseus-v0.0.1
  ListOfTables:
  - aws_cloudtrail_trail
  - aws_s3_bucket
  PrimaryTable: aws_cloudtrail_trail
  QueryToExecute: |
    select
      t.arn as resource,
      t.kaytu_account_id as kaytu_account_id,
      t.kaytu_resource_id as kaytu_resource_id,
      case
        when b.logging is not null then 'ok'
        else 'alarm'
      end as status,
      case
        when b.logging is not null then t.title || '''s logging bucket ' || t.s3_bucket_name || ' has access logging enabled.'
        else t.title || '''s logging bucket ' || t.s3_bucket_name || ' has access logging disabled.'
      end as reason
      
      , t.region, t.account_id
    from
      aws_cloudtrail_trail t
      inner join aws_s3_bucket b on t.s3_bucket_name = b.name
    where
      t.region = t.home_region;
Severity: medium
Tags:
  category:
  - Compliance
  cis:
  - "true"
  cis_item_id:
  - "2.6"
  cis_level:
  - "1"
  cis_section_id:
  - "2"
  cis_type:
  - scored
  cis_version:
  - v1.2.0
  plugin:
  - aws
  service:
  - AWS/CloudTrail
  x-kaytu-explanation:
  - "```markdown\n# S3 Bucket Access Logging\n\n**S3 Bucket Access Logging** is a powerful feature from Amazon Web Services that creates a detailed log record for every single request that is made to your S3 bucket. Each of these log records contains essential information about the request including:\n\n- **Request Type**: This details the nature of the request, whether it's a GET, PUT, DELETE or some other type of operation being performed on your S3 bucket.\n- **Resources Specified**: This segment contains information about the specific resources that the request interacted with in your S3 bucket.\n- **Timestamp**: This is a timestamp for when the request was processed.\n\nIt is highly **recommended** that access logging be enabled for your CloudTrail **S3 bucket**. This feature enhances the security of your S3 bucket and offers greater visibility into access patterns, potentially leading to the identification of access trends or anomalies.\n```"
  x-kaytu-noncompliance-cost:
  - "Non-compliance to this AWS control could result in several costs:\n\n1. **Security Risks**: If access logging is not enabled for your S3 buckets, you could miss out on vital information or signs of unauthorized access attempts or data breaches which can lead to serious security issues. Without these logs, it would be impossible to trace back the sources and paths of these threats, leaving your system vulnerable to future attacks.\n\n2. **Regulatory Violations**: Depending on the industry in which your business operates, non-compliance to access logging could be seen as a violation of specific regulations (HIPAA, GDPR, etc). The nature of data stored in S3 might require specific control and auditability mechanisms that include logging. If auditors can't verify and validate access control through logs this could lead to a fine or even license suspensions.\n\n4. **Operational Inefficiencies**: Logs often serve as an invaluable resource when troubleshooting system anomalies or performance issues. Without access logs, diagnosing and rectifying issues could become a difficult, time-consuming, and costly process.\n\n5. **Loss of Reputation and Trust**: In the event of a data breach, the inability to provide detailed logs may lead to a loss of trust with your clients and damage your brand's reputation, this could potentially even lead to loss of business.\n\n6. **Financial Implications**: As a result of data breaches, organizations can face direct financial losses. In addition, the process of recovery (forensic investigations, system recovery, legal penalties, etc.) from an incident can have significant costs.\n\nTherefore, it is essential to ensure that you are in compliance with this AWS control in order to protect and maintain your system's security and efficiency."
  x-kaytu-usefulness-example:
  - |-
    This AWS control is particularly useful in a range of scenarios, some of which include:

    - __Security Monitoring and Analysis:__ S3 Bucket Access Logging can be used to monitor who is accessing your data and what they're doing with it. For example, if unauthorized access or malicious activity is detected, you can conduct a thorough investigation using the log data. You can analyze the logs to understand how your data is accessed or changed, and strengthen your security posture based on these insights. 

    - __Compliance Auditing:__ Many industry regulations require logging and monitoring of data access. For instance, in case of an audit, you can use S3 Access Logs to prove that you're sufficiently tracking and controlling access to sensitive data stored in your S3 bucket. This makes it easier to demonstrate your organization's compliance with security standards like HIPAA or GDPR.

    - __Problem Diagnosis:__ If issues or errors occur in your S3 operations, you can review the access logs to understand what caused them. For example, if certain requests are failing, you can identify the failed request in the logs, view detailed information about the request, and diagnose the root cause.

    Example usage in markup language:
    ```markdown
    - **Security monitoring and forensic analysis:** S3 Bucket Access Logging is a boon when you need to track down who is accessing your data. In case of any unauthorized access, you can get to the bottom of the issue by analyzing the access logs.

    - **Compliance and audit needs:** S3 Bucket Access Logging is invaluable when you need to demonstrate compliance with various industry regulations. For instance, during a security audit, you can use these logs to show that you are keeping track of, and controlling access to, your data.

    - **Issue troubleshooting:** In case of problems with your S3 operations, you can utilize the S3 Bucket Access Logging to understand the problemâ€™s source. By investigating the records of the requests that are failing, you can diagnose and fix the issue in a timely manner.
    ```
    This makes S3 Bucket Access Logging a very practical and essential tool for maintaining data security and integrity, ensuring regulatory compliance, and troubleshooting issues.
Title: Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket
