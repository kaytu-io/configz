Description: IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.
DocumentURI: ""
ID: aws_iam_account_password_policy_reuse_24
Managed: true
ManualVerification: false
Query:
  Connector: AWS
  Engine: odysseus-v0.0.1
  ListOfTables:
  - aws_account
  - aws_iam_account_password_policy
  PrimaryTable: aws_account
  QueryToExecute: |
    select
      'arn:' || a.partition || ':::' || a.account_id as resource,
      a.kaytu_account_id as kaytu_account_id,
      a.kaytu_resource_id as kaytu_resource_id,
      case
        when password_reuse_prevention >= 24 then 'ok'
        else 'alarm'
      end as status,
      case
        when minimum_password_length is null then 'No password policy set.'
        when password_reuse_prevention is null then 'Password reuse prevention not set.'
        else 'Password reuse prevention set to ' || password_reuse_prevention || '.'
      end as reason
      , a.account_id
    from
      aws_account as a
      left join aws_iam_account_password_policy as pol on a.account_id = pol.account_id;
Severity: high
Tags:
  category:
  - Compliance
  cis:
  - "true"
  cis_item_id:
  - "1.10"
  cis_level:
  - "1"
  cis_section_id:
  - "1"
  cis_type:
  - scored
  cis_version:
  - v1.2.0
  plugin:
  - aws
  service:
  - AWS/IAM
  x-kaytu-explanation:
  - "```markdown\n# AWS IAM Password Policies\n\nAWS Identity and Access Management (IAM) allows you to manage access to AWS services and resources securely. A crucial aspect of this is **Password Policies**, which can be configured to prevent the reuse of a given password by the same user.\n\n## Recommended Configuration: Prevent Password Reuse \n\nIt is advisable to enable the prevention of password reuse as it enhances the overall security of your AWS resources. This configuration ensures that a user is not reusing a recently used password, making it difficult for unauthorized persons trying to crack the password.\n\nHere's how you can implement this policy:\n\n1. Go to the IAM dashboard.\n2. In the navigation pane, choose **Account Settings**.\n3. In the **Password policy** section, select **Prevent password reuse**.\n4. Define how many passwords AWS should remember to prevent reuse. For example, if you choose '5', IAM users won't be able to reuse their last five passwords.\n5. Click **Apply password policy**. \n\nRemember, an ideal password policy should not only prevent password reuse but also enforce password complexity requirements including a minimum length, necessitating at least one lowercase letter, one uppercase letter, one number, and one non-alphanumeric character.\n\nHaving such a policy in place reduces the risk of compromised credentials, thereby ensuring the security of your AWS infrastructure.\n```"
  x-kaytu-noncompliance-cost:
  - |-
    Non-compliance with the Amazon Web Services (AWS) Identity and Access Management (IAM) password policy that prevents the reuse of passwords can lead to several potential costs:

    1. **Security Breaches:** If old passwords can be reused, it increases the likelihood of successful attacks from malicious entities who may have gained previous passwords. The cost of a security breach could be enormous, leading to data theft, loss, or unauthorized access.

    2. **Regulatory Fines:** Many industries have regulations regarding data security, and failure to follow best practices for password policies can result in hefty fines or legal consequences.

    3. **Audit Failures:** Non-compliance with recommended controls may also cause a company to fail internal or external audits.

    4. **Reputation Damage:** If non-compliance leads to a security breach, the reputational damage can be significant. Clients and customers may lose trust in the organization, causing financial implications in the long term.

    5. **Incident Recovery Costs:** Remediation efforts to address security incidents consume time, money, and resources, which would otherwise be used for business growth.

    ```markup
    Hence, the costs of non-compliance to a robust IAM password policy go beyond just monetary losses; they affect the reputation and trustworthiness of the organization and can lead to significant business disruptions.
    ```
  x-kaytu-usefulness-example:
  - |-
    Example:

        Let's say you are running an organization with multiple AWS users having different levels of access and permissions. You notice that a certain user tends to reuse a specific password after every few password changes. This makes your system potentially vulnerable to attacks from hackers who could have previously accessed this particular password.

        To prevent this, you decide to enforce IAM password policies. This includes specifying a rule that bars any user from reusing their last five passwords. This way, even when the particular user tries to reuse a specific password they had used before, the system will automatically deny such an occurrence. 

        So, the IAM password policies add an extra layer of security to your AWS network by minimizing the possible predictability associated with password reuse and hence, reducing the likelihood of successful password cracking attempts.
Title: Ensure IAM password policy prevents password reuse
