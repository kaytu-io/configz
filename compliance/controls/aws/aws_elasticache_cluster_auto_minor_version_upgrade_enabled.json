{
  "ID": "aws_elasticache_cluster_auto_minor_version_upgrade_enabled",
  "Title": "Minor version upgrades should be automatically applied to ElastiCache for Redis cache clusters",
  "Description": "This control evaluates whether ElastiCache for Redis automatically applies minor version upgrades to cache clusters. This control fails if ElastiCache for Redis cache clusters do not have minor version upgrades automatically applied.",
  "Query": {
    "Engine": "odysseus-v0.0.1",
    "QueryToExecute": "select\n  arn as resource,\n  case\n    when auto_minor_version_upgrade then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when auto_minor_version_upgrade then title || ' automatic minor version upgrades enabled.'\n    else title || ' automatic minor version upgrades disabled.'\n  end as reason\n  \n  , region, account_id\nfrom\n  aws_elasticache_cluster;\n",
    "Connector": "AWS",
    "PrimaryTable": "aws_elasticache_cluster",
    "ListOfTables": [
      "aws_elasticache_cluster"
    ]
  },
  "ManualVerification": false,
  "Severity": "high",
  "Tags": {
    "aws_foundational_security": [
      "true"
    ],
    "category": [
      "Compliance"
    ],
    "foundational_security_category": [
      "vulnerability_patch_and_version_management"
    ],
    "foundational_security_item_id": [
      "elasticache_2"
    ],
    "plugin": [
      "aws"
    ],
    "service": [
      "AWS/ElastiCache"
    ]
  },
  "Managed": true
}