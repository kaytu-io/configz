ID: aws_es_domain_node_to_node_encryption_enabled
Title: Elasticsearch domain node-to-node encryption should be enabled
Description: Ensure node-to-node encryption for Amazon Elasticsearch Service is enabled. Node-to-node encryption enables TLS 1.2 encryption for all communications within the Amazon Virtual Private Cloud (Amazon VPC).
Query:
    ID: ""
    Engine: odysseus-v0.0.1
    QueryToExecute: "select\n  arn as resource,\n  kaytu_account_id as kaytu_account_id,\n  kaytu_resource_id as kaytu_resource_id,\n  case\n    when region = any(array['af-south-1', 'eu-south-1', 'cn-north-1', 'cn-northwest-1']) then 'skip'\n    when not enabled then 'alarm'\n    else 'ok'\n  end as status,\n  case\n    when region = any(array['af-south-1', 'eu-south-1', 'cn-north-1', 'cn-northwest-1']) then title || ' node-to-node encryption not supported in ' || region || '.'\n    when not enabled then title || ' node-to-node encryption disabled.'\n    else title || ' node-to-node encryption enabled.'\n  end as reason\n  \n  , region, account_id\nfrom\n  aws_elasticsearch_domain;\n"
    Connector: AWS
    PrimaryTable: aws_elasticsearch_domain
    ListOfTables:
        - aws_elasticsearch_domain
    Parameters: []
ManualVerification: false
Severity: high
Tags:
    category:
        - Compliance
    cisa_cyber_essentials:
        - "true"
    fedramp_low_rev_4:
        - "true"
    fedramp_moderate_rev_4:
        - "true"
    ffiec:
        - "true"
    gdpr:
        - "true"
    gxp_21_cfr_part_11:
        - "true"
    hipaa_final_omnibus_security_rule_2013:
        - "true"
    hipaa_security_rule_2003:
        - "true"
    nist_800_53_rev_4:
        - "true"
    nist_800_53_rev_5:
        - "true"
    nist_800_171_rev_2:
        - "true"
    nist_csf:
        - "true"
    pci_dss_v321:
        - "true"
    plugin:
        - aws
    rbi_cyber_security:
        - "true"
    service:
        - AWS/ES
    soc_2:
        - "true"
Managed: false
