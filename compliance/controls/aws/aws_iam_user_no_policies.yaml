ID: aws_iam_user_no_policies
Title: Ensure IAM policies are attached only to groups or roles
Description: By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.
Query:
    ID: ""
    Engine: odysseus-v0.0.1
    QueryToExecute: "select\n  arn as resource,\n  kaytu_account_id as kaytu_account_id,\n  kaytu_resource_id as kaytu_resource_id,\n  case\n    when attached_policy_arns is null then 'ok'\n    else 'alarm'\n  end status,\n  name || ' has ' || coalesce(jsonb_array_length(attached_policy_arns),0) || ' attached policies.' as reason\n  \n  , account_id\nfrom\n  aws_iam_user;\n"
    Connector: AWS
    PrimaryTable: aws_iam_user
    ListOfTables:
        - aws_iam_user
    Parameters: []
ManualVerification: false
Severity: medium
Tags:
    category:
        - Compliance
    cis:
        - "true"
    cis_item_id:
        - "1.16"
    cis_level:
        - "1"
    cis_section_id:
        - "1"
    cis_type:
        - scored
    cis_version:
        - v1.2.0
    plugin:
        - aws
    service:
        - AWS/IAM
Managed: false
