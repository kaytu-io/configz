ID: azuread_get_all_service_principals_in_azuread_with_more_than_one_client_secret_that_is_active
Title: Get all Service Principals in AzureAD with more than one Client Secret that is active
Description: Ensure that Azure Key Vault certificates are using the appropriate key type(s).
Query:
  ID: ""
  Engine: odysseus-v0.0.1
  QueryToExecute: |
    select
      *
    from
      azuread_application
    where
      (select count(*) from jsonb_array_elements(password_credentials) as pc) > 1
  Connector: Azure
  PrimaryTable: azuread_application
  ListOfTables:
    - azuread_application
ManualVerification: false
Severity: medium
Tags:
  score_service_name:
    - Azure KeyVault
Managed: false
