Connector: AWS
Description: Ensure fewer Amazon RDS instances than the established limit in your AWS account.
Enabled: true
ID: aws_rds_instance_counts
Internal: false
Links: null
LogoURL: ""
LongTitle: Ensure fewer Amazon RDS instances than the established limit in your AWS account.
RiskLevel: Medium
Query:
  Connector: AWS
  Engine: odysseus-v0.0.1
  ID:
  ListOfTables:
    - aws_rds_db_instance
  PrimaryTable: aws_rds_db_instance
  QueryToExecute: |-
    select 
      kaytu_account_id as kaytu_account_id,
      count(*) RDS_Instances_Count,
      case
        when count(*) > 10 then 'alarm'
        else 'ok'
      end status,
      case
        when count(*) > 10 then 'The limit the number of RDS instances exceeded'
        else 'The limit the number of RDS instances not exceeded'
      end reason,
      account_id
    from 
      aws_rds_db_instance 
    group by 
      kaytu_account_id, account_id;
ShortTitle: RDS Instance Counts
Tags:
  category: