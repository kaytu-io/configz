Description: Disabling the public network access property improves security by ensuring
  your Azure Database for MySQL flexible servers can only be accessed from a private
  endpoint. This configuration strictly disables access from any public address space
  outside of Azure IP range and denies all logins that match IP or virtual network-based
  firewall rules.
ID: public_network_access_should_be_disabled_for_my_sql_flexible_servers
Query:
  Connector: Azure
  Engine: odysseus-v0.0.1
  QueryToExecute: 'SELECT id, name, kaytu_description

    FROM azure_dbformysql_flexibleservers

    WHERE kaytu_description->''definitions''->''Network''->>''PrivateDNSZoneResourceID''
    IS NULL

    AND kaytu_description->''definitions''->''Network''->>''PublicNetworkAccess''
    != ''Disabled''

    AND kaytu_description->''definitions''->''Network''->>''DelegatedSubnetResourceID''
    IS NULL

    AND kaytu_description->''type''->>''value'' = ''Microsoft.DBforMySQL/flexibleServers''

    LIMIT 5;;

    '
Severity: ''
Title: Public network access should be disabled for MySQL flexible servers
