{
  "ID": "azure_securitycenter_azure_defender_on_for_keyvault",
  "Title": "Ensure that Azure Defender is set to On for Key Vault",
  "Description": "Turning on Azure Defender enables threat detection for Key Vault, providing threat intelligence, anomaly detection, and behavior analytics in the Azure Security Center.",
  "Query": {
    "Connector": "Azure",
    "Engine": "odysseus-v0.0.1",
    "ListOfTables": [
      "azure_security_center_subscription_pricing",
      "azure_subscription"
    ],
    "PrimaryTable": "azure_security_center_subscription_pricing",
    "QueryToExecute": "select\n  sub_pricing.id as resource,\n  sub_pricing.kaytu_account_id as kaytu_account_id,\n  sub_pricing.kaytu_resource_id as kaytu_resource_id,\n  case\n    when pricing_tier = 'Standard' then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when pricing_tier = 'Standard' then 'Azure Defender on for Key Vaults.'\n    else 'Azure Defender off for Key Vaults.'\n  end as reason\n  \n  , sub.display_name as subscription\nfrom\n  azure_security_center_subscription_pricing sub_pricing\n  right join azure_subscription sub on sub_pricing.subscription_id = sub.subscription_id\nwhere\n  name = 'KeyVaults';\n"
  },
  "DocumentURI": "",
  "ManualVerification": false,
  "Severity": "low",
  "Tags": {
    "category": [
      "Compliance"
    ],
    "cis": [
      "true"
    ],
    "cis_item_id": [
      "2.8"
    ],
    "cis_level": [
      "2"
    ],
    "cis_section_id": [
      "2"
    ],
    "cis_type": [
      "manual"
    ],
    "cis_version": [
      "v1.3.0"
    ],
    "plugin": [
      "azure"
    ],
    "service": [
      "Azure/SecurityCenter"
    ],
    "x-kaytu-explanation": [
      "This action activates threat detection capabilities, including the use of threat intelligence, anomaly detection, and behavior analytics within the Azure Security Center.\n\n"
    ],
    "x-kaytu-noncompliance-cost": [
      "The cost of non-compliance with the specified Azure Control, which involves turning on Azure Defender for Key Vault, may include increased vulnerability to security threats, potential data breaches, and compromised integrity of key vault contents. Non-compliance could lead to financial losses, damage to reputation, and legal consequences.\n\n"
    ],
    "x-kaytu-usefulness-example": [
      "An example instance of the usefulness of the specified Azure Control is its role in detecting a suspicious attempt to access sensitive information stored in Key Vault. With Azure Defender enabled, the system can identify the threat, analyze anomalous activities, and apply behavior analytics to prevent unauthorized access. This enhances overall security, protects sensitive data, and ensures compliance with security best practices.\n"
    ]
  },
  "Managed": true
}