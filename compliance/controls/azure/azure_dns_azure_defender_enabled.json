{
  "ID": "azure_dns_azure_defender_enabled",
  "Title": "Azure Defender for DNS should be enabled",
  "Description": "Azure Defender for DNS provides an additional layer of protection for your cloud resources by continuously monitoring all DNS queries from your Azure resources. Azure Defender alerts you about suspicious activity at the DNS layer.",
  "Query": {
    "Engine": "odysseus-v0.0.1",
    "QueryToExecute": "select\n  pricing.id as resource,\n  pricing.kaytu_account_id as kaytu_account_id,\n  pricing.kaytu_resource_id as kaytu_resource_id,\n  case\n    when name = 'Dns' and pricing_tier = 'Standard' then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when name = 'Dns' and pricing_tier = 'Standard' then 'Dns azure defender enabled.'\n    else name || 'Dns azure defender disabled.'\n  end as reason\n  \n  , sub.display_name as subscription\nfrom\n  azure_security_center_subscription_pricing as pricing,\n  azure_subscription as sub\nwhere\n  sub.subscription_id = pricing.subscription_id\n  and name = 'Dns';\n",
    "Connector": "Azure",
    "PrimaryTable": "azure_security_center_subscription_pricing",
    "ListOfTables": [
      "azure_security_center_subscription_pricing",
      "azure_subscription"
    ]
  },
  "ManualVerification": false,
  "Severity": "",
  "Tags": {
    "nist_sp_800_53_rev_5": [
      "true"
    ],
    "service": [
      "Azure/DNS"
    ]
  },
  "Managed": true
}