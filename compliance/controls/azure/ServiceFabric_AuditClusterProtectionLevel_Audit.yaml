Description: Service Fabric provides three levels of protection (None, Sign and EncryptAndSign)
  for node-to-node communication using a primary cluster certificate. Set the protection
  level to ensure that all node-to-node messages are encrypted and digitally signed
ID: service_fabric_clusters_should_have_the_cluster_protection_level_property_set_to_encrypt_and_sign
Query:
  Connector: Azure
  Engine: odysseus-v0.0.1
  QueryToExecute: "SELECT name, kaytu_description->'Cluster'->'properties'->'fabricSettings'->>0->>'name'\
    \ AS fabric_settings_name, kaytu_description->'Cluster'->'properties'->'fabricSettings'->0->'parameters'->>0->>'name'\
    \ AS parameter_name, kaytu_description->'Cluster'->'properties'->'fabricSettings'->0->'parameters'->>0->>'value'\
    \ AS parameter_value\nFROM azure_service_fabric_cluster\nWHERE type = 'Microsoft.ServiceFabric/clusters'\n\
    AND (\n    (fabric_settings_name != 'Security')\n    OR (parameter_name != 'ClusterProtectionLevel')\n\
    \    OR (parameter_value != 'EncryptAndSign')\n)\nLIMIT 5;;\n"
Severity: ''
Title: Service Fabric clusters should have the ClusterProtectionLevel property set
  to EncryptAndSign
