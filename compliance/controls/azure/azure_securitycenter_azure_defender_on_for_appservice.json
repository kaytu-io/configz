{
  "ID": "azure_securitycenter_azure_defender_on_for_appservice",
  "Title": "Ensure that Azure Defender is set to On for App Service",
  "Description": "Turning on Azure Defender enables threat detection for App Service, providing threat intelligence, anomaly detection, and behavior analytics in the Azure Security Center.",
  "QueryID": null,
  "Query": {
    "Connector": "Azure",
    "Engine": "odysseus-v0.0.1",
    "ListOfTables": [
      "azure_security_center_subscription_pricing",
      "azure_subscription"
    ],
    "PrimaryTable": "azure_security_center_subscription_pricing",
    "QueryToExecute": "select\n  sub_pricing.id as resource,\n  sub_pricing.kaytu_account_id as kaytu_account_id,\n  sub_pricing.kaytu_resource_id as kaytu_resource_id,\n  case\n    when pricing_tier = 'Standard' then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when pricing_tier = 'Standard' then 'Azure Defender on for App Services.'\n    else 'Azure Defender off for App Services.'\n  end as reason\n  \n  , sub.display_name as subscription\nfrom\n  azure_security_center_subscription_pricing sub_pricing\n  right join azure_subscription sub on sub_pricing.subscription_id = sub.subscription_id\nwhere\n  name = 'AppServices';\n"
  },
  "DocumentURI": "",
  "ManualVerification": false,
  "Severity": "low",
  "Tags": {
    "category": [
      "Compliance"
    ],
    "cis": [
      "true"
    ],
    "cis_item_id": [
      "2.2"
    ],
    "cis_level": [
      "2"
    ],
    "cis_section_id": [
      "2"
    ],
    "cis_type": [
      "manual"
    ],
    "cis_version": [
      "v1.3.0"
    ],
    "plugin": [
      "azure"
    ],
    "service": [
      "Azure/SecurityCenter"
    ],
    "x-kaytu-explanation": [
      "It seems like there might be a mistake in the question as it's mixing up Azure and AWS, which are two different cloud providers. Therefore, I'll explain the control based on Azure.\n\n```markdown\n# Azure Defender for App Service\n\nAzure Defender is a cloud-based security feature in Azure Security Center that provides extensive threat protection capabilities for Azure services. When it is specifically enabled for Azure App Service, it provides:\n\n- **Threat Intelligence**: Identifies potential threats to your web apps by correlating threat data with your app's activities and detecting any suspicious behavior.\n\n- **Anomaly Detection**: Uses advanced analytics and machine learning to identify activities that differ significantly from the normal behavior, indicating potential security threats.\n\n- **Behavior Analytics**: Continuously monitors your web app's behavior and identifies any unusual behavior patterns, which might signal potential security risk.\n\nBy turning on Azure Defender, you're effectively augmenting your App Service's security, making it harder for bad actors to compromise your application. With its continuous security health monitoring and enhanced threat protection, it significantly improves your application's security posture.\n```\nNote: This explanation is in the context of Azure, not AWS. AWS has a similar feature called AWS Shield for threat detection and protection."
    ],
    "x-kaytu-noncompliance-cost": [
      "The control you mentioned is related to Microsoft Azure, not AWS (Amazon Web Services). Hence, AWS doesn't enforce any cost for non-compliance with this control.\n\nNevertheless, if you are referring to the risk for not complying with similar security measures in AWS, below is an explanation.\n\nNon-compliance with specific security measures, such as AWS Shield or AWS GuardDuty, could result in the following costs:\n\n**Financial Costs:**\n\n1. **Data Breaches:** Without adequate threat detection, systems are vulnerable to hacking, which can lead to data breaches. The average cost of a data breach globally is $3.86 million, according to a report by IBM Security.\n\n2. **System Downtime:** Cyberattacks can lead to system downtime, which breeches business operation and results in lost revenue.\n\n**Reputation Costs:**\n\n3. **Customer Trust:** Data breaches can severely damage a company's reputation, leading to loss of customers.\n\n4. **Regulatory Fines and Penalties:** In todayâ€™s world of strict privacy regulations (such as GDPR), a data breach due to non-compliance with recommended security controls can result in substantial regulatory fines.\n\n5. **Legal Costs:** Organizations may face lawsuits from customers and partners in the case of a data breach.\n\nAll these could lead to substantial immediate and future costs that are often far higher than the cost of deploying a threat detection system. Therefore, ensuring adequate security measures is extremely critical. \n\nHowever, it's essential to mention that each organization would need a tailored approach towards cloud security since the threats and risks vary in nature and severity depending on the organization's size, industry, and the nature of the data it handles."
    ],
    "x-kaytu-usefulness-example": [
      "An eCommerce company wants to ensure the security of its customer's data. They launch a web application on Microsoft Azure. To enhance security and safeguard their application from threats, they turn on Azure Defender. This service, which is highly integrated with Azure Security Center, provides threat intelligence and anomaly detection. \n\nFor instance, Azure Defender detected an unusual attempted login from an unknown IP address. This behavior was flagged as an anomaly and an alert was triggered in Azure Security Center. Upon receiving the alert, the built-in incident response systems were triggered, successfully mitigating the threat. This averted a potential data breach, saving the company from potential revenue loss and damage to their reputation.\n\nHence, by using Azure Defender, the eCommerce company was able to add an additional layer of protection to their Azure App Service, providing greater confidence in their overall cloud security posture. This is an example of the usefulness of the AWS control in securing web applications from threats."
    ]
  },
  "Managed": true
}