Description: Cross-Origin Resource Sharing (CORS) should not allow all domains to
  access your Function app. Allow only required domains to interact with your Function
  app.
ID: function_apps_should_not_have_cors_configured_to_allow_every_resource_to_access_your_apps
Query:
  Connector: Azure
  Engine: odysseus-v0.0.1
  QueryToExecute: 'SELECT azure_app_service_function_app.name, azure_app_service_function_app.kind,
    azure_app_service_function_app.kaytu_description->''config''->''web''->''cors''->>''allowedOrigins''

    FROM azure_app_service_function_app

    WHERE azure_app_service_function_app.type = ''Microsoft.Web/sites''

    AND (azure_app_service_function_app.kind LIKE ''%functionapp%'' AND azure_app_service_function_app.kind
    NOT LIKE ''%workflowapp%'')

    AND (azure_app_service_function_app.kaytu_description->''config''->''web''->''cors''->>''allowedOrigins''
    IS NOT NULL

    OR azure_app_service_function_app.kaytu_description->''kind'' IS NOT NULL)

    LIMIT 5;;

    '
Severity: ''
Title: Function apps should not have CORS configured to allow every resource to access
  your apps
