Description: Deploys the diagnostic settings for Batch Account to stream to a regional
  Event Hub when any Batch Account which is missing this diagnostic settings is created
  or updated.
ID: deploy_diagnostic_settings_for_batch_account_to_event_hub
Query:
  Connector: Azure
  Engine: odysseus-v0.0.1
  QueryToExecute: 'SELECT *

    FROM azure_batch_account

    WHERE type = ''Microsoft.Batch/batchAccounts''

    AND (kaytu_description ->> ''Account.Properties.NetworkProfile.NodeManagementAccess.IPRules'')::jsonb
    @> ''[{"Value": "Microsoft.Insights/diagnosticSettings/logs.enabled"}]''

    AND (kaytu_description ->> ''Account.Properties.NetworkProfile.NodeManagementAccess.IPRules'')::jsonb
    @> ''[{"Value": "Microsoft.Insights/diagnosticSettings/metrics.enabled"}]''

    LIMIT 5;;

    '
Severity: ''
Title: Deploy Diagnostic Settings for Batch Account to Event Hub
