Description: Use customer-managed keys to control the encryption at rest of the data
  stored in Azure Synapse workspaces. Customer-managed keys deliver double encryption
  by adding a second layer of encryption on top of the default encryption with service-managed
  keys.
ID: azure_synapse_workspaces_should_use_customer_managed_keys_to_encrypt_data_at_rest
Query:
  Connector: Azure
  Engine: odysseus-v0.0.1
  QueryToExecute: "SELECT *\nFROM azure_synapse_workspace\nWHERE type = 'Microsoft.Synapse/workspaces'\n\
    AND (\n  encryption->'cmk'->'key'->>'name' IS NULL\n  OR kaytu_description->'defs'->'EncryptionDetails'->'properties'->'Cmk'->'defs'->'CustomerManagedKeyDetails'->'properties'->'Key'->'defs'->'WorkspaceKeyDetails'->'properties'->>'Name'\
    \ IS NULL\n)\nLIMIT 5;;\n"
Severity: ''
Title: Azure Synapse workspaces should use customer-managed keys to encrypt data at
  rest
