{
  "ID": "azure_network_watcher_enabled",
  "Title": "Ensure that Network Watcher is 'Enabled'",
  "Description": "Enable Network Watcher for Azure subscriptions.",
  "Query": {
    "Connector": "Azure",
    "Engine": "odysseus-v0.0.1",
    "ListOfTables": [
      "azure_location",
      "azure_network_watcher",
      "azure_subscription"
    ],
    "PrimaryTable": "azure_location",
    "QueryToExecute": "select\n  loc.id resource,\n  loc.kaytu_account_id as kaytu_account_id,\n  loc.kaytu_resource_id as kaytu_resource_id,\n  case\n    when watcher.id is null then 'alarm'\n    else 'ok'\n  end as status,\n  case\n    when watcher.id is null then 'Network watcher not enabled in ' || loc.name || '.'\n    else 'Network watcher enabled in ' || loc.name || '.'\n  end as reason,\n  loc.name\n  \n  \n  , sub.display_name as subscription\nfrom\n  azure_location loc\n  left join azure_network_watcher watcher on watcher.region = loc.name\n  join azure_subscription sub on sub.subscription_id = loc.subscription_id;\n"
  },
  "DocumentURI": "",
  "ManualVerification": false,
  "Severity": "medium",
  "Tags": {
    "category": [
      "Compliance"
    ],
    "cis": [
      "true"
    ],
    "cis_item_id": [
      "6.5"
    ],
    "cis_level": [
      "1"
    ],
    "cis_section_id": [
      "6"
    ],
    "cis_type": [
      "manual"
    ],
    "cis_version": [
      "v1.3.0"
    ],
    "plugin": [
      "azure"
    ],
    "service": [
      "Azure/Network"
    ],
    "x-kaytu-explanation": [
      "The Azure Control for enabling Network Watcher in Azure subscriptions involves using the Azure Resource Manager (ARM) template or PowerShell scripting. Here's a basic example in ARM template format:\n\njson\n\n{\n  \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\n  \"contentVersion\": \"1.0.0.0\",\n  \"resources\": [\n    {\n      \"apiVersion\": \"2019-04-01\",\n      \"type\": \"Microsoft.Network/watchers\",\n      \"name\": \"networkWatcherName\",\n      \"location\": \"eastus\",\n      \"properties\": {\n        // Additional properties as needed\n      }\n    }\n  ]\n}\nThis template creates a Network Watcher in the \"eastus\" region. You can customize the parameters based on your requirements."
    ],
    "x-kaytu-noncompliance-cost": [
      "The cost of non-compliance with the Azure Control to enable Network Watcher for Azure subscriptions can vary. It may result in increased security risks, potential network issues, and difficulties in monitoring and troubleshooting. Additionally, non-compliance might lead to violations of regulatory requirements, potentially resulting in financial penalties. The exact cost depends on the impact of network-related issues, the severity of security breaches, and any legal consequences.\n\n"
    ],
    "x-kaytu-usefulness-example": [
      "Enabling Network Watcher for Azure subscriptions is useful for various scenarios. One example is troubleshooting network connectivity issues. With Network Watcher, you can use tools like \"Connection Monitor\" to identify and diagnose connectivity problems between Azure resources. This can significantly reduce the time it takes to identify and resolve network-related issues, improving the overall reliability and performance of your Azure environment.\n\n\n\n\n\n"
    ]
  },
  "Managed": true
}