Description: Client certificates allow for the app to request a certificate for incoming
  requests. Only clients that have a valid certificate will be able to reach the app.
  This policy applies to apps with Http version set to 1.1.
ID: app_service_apps_should_have_client_certificates_(_incoming_client_certificates)_enabled
Query:
  Connector: Azure
  Engine: odysseus-v0.0.1
  QueryToExecute: "SELECT *\nFROM azure_app_service_function_app\nWHERE type = 'Microsoft.Web/sites'\n\
    AND (kind IS NULL OR kind NOT LIKE '%functionapp%')\nAND (client_cert_enabled\
    \ IS NULL OR client_cert_enabled != true)\nAND (site_config -> 'web' ->> 'http20Enabled'\
    \ = 'true'\n     OR kaytu_description -> 'SiteConfig' -> 'properties' ->> 'http20Enabled'\
    \ = 'true')\nAND (kaytu_description -> 'Site' -> 'properties' ->> 'clientCertEnabled'\
    \ IS NULL\n     OR kaytu_description -> 'Site' -> 'properties' ->> 'clientCertEnabled'\
    \ != 'true')\nLIMIT 5;;\n"
Severity: ''
Title: App Service apps should have Client Certificates (Incoming client certificates)
  enabled
