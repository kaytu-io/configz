{
  "ID": "azure_ad_guest_user_reviewed_monthly",
  "Title": "Ensure guest users are reviewed on a monthly basis",
  "Description": "Guest users allow you to share your company's applications and services with users from any other organization, while maintaining control over your own corporate data. Guest users should be review on a monthly basis to ensure that inactive and unneeded accounts are removed.",
  "Query": {
    "Connector": "Azure",
    "Engine": "odysseus-v0.0.1",
    "ListOfTables": [
      "azure_tenant",
      "azuread_user",
      "azure_tenant",
      "azuread_user"
    ],
    "PrimaryTable": "azuread_user",
    "QueryToExecute": "select\n  u.display_name as resource,\n  u.kaytu_account_id as kaytu_account_id,\n  u.kaytu_resource_id as kaytu_resource_id,\n  case\n    when not account_enabled then 'alarm'\n    when u.created_date_time::timestamp \u003c= (current_date - interval '30' day) then 'alarm'\n    else 'ok'\n  end as status,\n  case\n    when not account_enabled then 'Guest user ''' || u.display_name || ''' inactive.'\n    else 'Guest user ''' || u.display_name || ''' was created ' || extract(day from current_timestamp - u.created_date_time::timestamp) || ' days ago.'\n  end as reason,\n  t.tenant_id\n  \nfrom\n  azuread_user as u\n  left join azure_tenant as t on t.tenant_id = u.tenant_id\nwhere\n  u.user_type = 'Guest';\n"
  },
  "DocumentURI": "",
  "ManualVerification": false,
  "Severity": "medium",
  "Tags": {
    "category": [
      "Compliance"
    ],
    "cis": [
      "true"
    ],
    "cis_item_id": [
      "1.3"
    ],
    "cis_level": [
      "1"
    ],
    "cis_section_id": [
      "1"
    ],
    "cis_type": [
      "automated"
    ],
    "cis_version": [
      "v1.3.0"
    ],
    "plugin": [
      "azure"
    ],
    "service": [
      "Azure/ActiveDirectory"
    ],
    "x-kaytu-explanation": [
      "# AWS Control: Guest Users\n\nAWS provides the functionality to invite guest users, allowing you to share applications and services with users from different organizations. This feature is aimed at improving the collaborative efforts without forfeiting control over your corporate data.\n\n## **Instructions**\n\n1. **Inviting Guest Users**: You can invite guest users to join your organization's applications and services. This is especially beneficial for organizations that are working on a joint project or collaborating in any form.\n\n2. **Access Control**: Despite guest users having access to your company's applications and services, you maintain complete control and authority over your corporate data.\n\n3. **Monthly Review**: It is recommended that the guest users are reviewed on a monthly basis. During this review, ensure that all inactive and unneeded accounts are identified and promptly removed.\n\n4. **Security**: The periodic review helps in maintaining the security and preventing any potential misuse of access that might compromise your company's data and privacy.\n\nEnsure that your organization is using AWS Control features responsibly and actively to maintain the best possible security standards.\n\nPlease note that all the guest user activities do not jeopardize the prime data governance authority, and the company always retains the rights to monitor, revoke, or restrict access whenever deemed necessary.\n\nAlways make sure that all AWS controls are used as intended in order to maintain a secure and healthy online environment for your business."
    ],
    "x-kaytu-noncompliance-cost": [
      "The cost of non-compliance to this AWS control can be significant and varies based on a couple of factors. The cost can present itself in various ways, ranging from financial losses, reputational damage, to breach of important data.\n\n1. **Increased Resource Utilization Costs**: Each user account on AWS consumes some resources. Even if a guest user is not actively using the shared applications, their user account settings, permissions, and data take up storage space, consume processing power and potentially increase data transfer costs. If unneeded or inactive accounts are not removed, these costs can accumulate over time.\n\n2. **Security Risks**: Unused and unmanaged guest accounts pose potential security risks. If an account is compromised, it could lead to unauthorized access to your company's applications and services, which could then lead to data breaches.\n\n3. **Compliance Fines**: Depending on the specific regulations your organization is subject to, you could be fined for not keeping a tight control on user accounts and data access. Regulations like GDPR, HIPAA, and others require stringent user access controls.\n\n4. **Data Management Complication**: Having numerous guest user accounts can make data management more complex and error-prone.\n\n5. **Reputational Damage**: If inactive and unneeded accounts are mishandled and it leads to data breaches, your business stands the risk of damaging its reputation. Damage to a company's reputation can cost millions and take years to repair.\n\nIn essence, it is crucial to review guest users regularly and delete unused and unneeded accounts to comply with this AWS control."
    ],
    "x-kaytu-usefulness-example": [
      "For instance, a marketing agency that is using AWS resources to plan and execute digital campaign strategies for its multiple clients could highly benefit from the guest users feature. This agency can create guest user accounts for their clients to provide them with real-time data and analytics about their campaigns.\n\nThe example usage of AWS Control can look like this in a markup format:\n\n```\n# Case Study: Marketing Agency \n\nWe are using the **Guest Users** feature provided by AWS to optimize collaborative tasks with our clients.\n\n## Benefits \u0026 Usefulness\n- **Data Accessibility** \n   Clients can access necessary information anytime, anywhere. This has eliminated the lengthy process of data sharing and report generation.\n- **Real-Time Insights**\n   Real data sharing allows clients to get real-time insights about their campaigns.\n- **Security \u0026 Control**\n   We retain control over our own corporate data while giving clients access to their specific campaign data.\n\n## Control Mechanism\n- **Monthly Review**\n    To maintain system security, a systematic review of all guest user accounts is conducted on a monthly basis, and inactive and unneeded accounts are deleted. \n```\n\nThis way, the users will get a clear understanding of the usefulness of AWS Control, and how it can be implemented in their business scenarios."
    ]
  },
  "Managed": true
}