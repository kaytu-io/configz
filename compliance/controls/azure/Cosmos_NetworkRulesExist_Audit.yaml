Description: Firewall rules should be defined on your Azure Cosmos DB accounts to
  prevent traffic from unauthorized sources. Accounts that have at least one IP rule
  defined with the virtual network filter enabled are deemed compliant. Accounts disabling
  public access are also deemed compliant.
ID: azure_cosmos_db_accounts_should_have_firewall_rules
Query:
  Connector: Azure
  Engine: odysseus-v0.0.1
  QueryToExecute: "SELECT kaytu_description->'DatabaseAccountGetProperties'->'IPRules'\
    \ AS ip_rules,\n       kaytu_description->'DatabaseAccountGetProperties'->>'IPRangeFilter'\
    \ AS ip_range_filter,\n       azure_cosmosdb_account.is_virtual_network_filter_enabled,\n\
    \       azure_cosmosdb_account.public_network_access\nFROM azure_cosmosdb_account\n\
    WHERE azure_cosmosdb_account.type = 'Microsoft.DocumentDB/databaseAccounts'\n\
    \  AND (azure_cosmosdb_account.ip_rules IS NOT NULL OR\n       jsonb_array_length(kaytu_description->'DatabaseAccountGetProperties'->'IPRules')\
    \ = 0)\n  AND (azure_cosmosdb_account.ip_range_filter IS NOT NULL OR\n       kaytu_description->'DatabaseAccountGetProperties'->>'IPRangeFilter'\
    \ = '')\nLIMIT 5;;\n"
Severity: ''
Title: Azure Cosmos DB accounts should have firewall rules
