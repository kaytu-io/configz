Description: Deleting a key vault without soft delete enabled permanently deletes
  all secrets, keys, and certificates stored in the key vault. Accidental deletion
  of a key vault can lead to permanent data loss. Soft delete allows you to recover
  an accidentally deleted key vault for a configurable retention period.
ID: key_vaults_should_have_soft_delete_enabled
Query:
  Connector: Azure
  Engine: odysseus-v0.0.1
  QueryToExecute: "SELECT *\nFROM azure_key_vault\nWHERE type = 'Microsoft.KeyVault/vaults'\n\
    AND (create_mode IS NULL OR create_mode != 'recover')\nAND (\n    (\n        (kaytu_description\
    \ -> 'definitions' -> 'Vault' -> 'properties' -> 'properties' ->> 'createMode')\
    \ IS NULL\n        OR (kaytu_description -> 'definitions' -> 'Vault' -> 'properties'\
    \ -> 'properties' ->> 'createMode') != 'recover'\n    )\n    AND (\n        (\n\
    \            (kaytu_description -> 'definitions' -> 'Vault' -> 'properties' ->\
    \ 'properties' ->> 'enableSoftDelete') IS NULL\n            OR (kaytu_description\
    \ -> 'definitions' -> 'Vault' -> 'properties' -> 'properties' ->> 'enableSoftDelete')\
    \ = 'false'\n        )\n        OR NOT (kaytu_description -> 'definitions' ->\
    \ 'Vault' -> 'properties' -> 'properties' ? 'enableSoftDelete')\n    )\n)\nLIMIT\
    \ 5;;\n"
Severity: ''
Title: Key vaults should have soft delete enabled
