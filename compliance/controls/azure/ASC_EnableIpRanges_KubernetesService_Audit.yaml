Description: Restrict access to the Kubernetes Service Management API by granting
  API access only to IP addresses in specific ranges. It is recommended to limit access
  to authorized IP ranges to ensure that only applications from allowed networks can
  access the cluster.
ID: authorized_ip_ranges_should_be_defined_on_kubernetes_services
Query:
  Connector: Azure
  Engine: odysseus-v0.0.1
  QueryToExecute: "SELECT *\nFROM azure_kubernetes_cluster\nWHERE type = 'Microsoft.ContainerService/managedClusters'\n\
    AND (\n  (api_server_access_profile ->> 'enablePrivateCluster' = 'false' OR NOT\
    \ api_server_access_profile ? 'enablePrivateCluster')\n  AND (api_server_access_profile\
    \ ->> 'authorizedIPRanges' IS NULL OR NOT api_server_access_profile ? 'authorizedIPRanges')\n\
    \  OR (kaytu_description -> 'definitions' -> 'ManagedClusterAPIServerAccessProfile'\
    \ -> 'properties' ->> 'enablePrivateCluster' = 'false' OR NOT kaytu_description\
    \ ? 'definitions.ManagedClusterAPIServerAccessProfile.properties.enablePrivateCluster')\n\
    \  AND (kaytu_description -> 'definitions' -> 'ManagedClusterAPIServerAccessProfile'\
    \ -> 'properties' ->> 'authorizedIPRanges' IS NULL OR NOT kaytu_description ?\
    \ 'definitions.ManagedClusterAPIServerAccessProfile.properties.authorizedIPRanges')\n\
    )\nLIMIT 5;;\n"
Severity: ''
Title: Authorized IP ranges should be defined on Kubernetes Services
