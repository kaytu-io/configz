Description: Azure App Service Authentication is a feature that can prevent anonymous
  HTTP requests from reaching the Function app, or authenticate those that have tokens
  before they reach the Function app.
ID: function_apps_should_have_authentication_enabled
Query:
  Connector: Azure
  Engine: odysseus-v0.0.1
  QueryToExecute: 'SELECT *

    FROM azure_app_service_function_app

    WHERE type = ''Microsoft.Web/sites''

    AND (kind LIKE ''%functionapp%'' AND kind NOT LIKE ''%workflowapp%'')

    AND (site_config ->> ''siteAuthEnabled'' = ''true'' OR kaytu_description -> ''SiteAuthSettings''
    ->> ''properties'' ->> ''enabled'' = ''true'')

    LIMIT 5;;

    '
Severity: medium
Title: Function apps should have authentication enabled
