Description: 'Azure container registries by default accept connections over the internet
  from hosts on any network. To protect your registries from potential threats, allow
  access from only specific private endpoints, public IP addresses or address ranges.
  If your registry doesn''t have network rules configured, it will appear in the unhealthy
  resources. Learn more about Container Registry network rules here: https://aka.ms/acr/privatelink,
  https://aka.ms/acr/portal/public-network and https://aka.ms/acr/vnet.'
ID: container_registries_should_not_allow_unrestricted_network_access
Query:
  Connector: Azure
  Engine: odysseus-v0.0.1
  QueryToExecute: "SELECT name, kaytu_description->'definitions'->'RegistryProperties'->'properties'->'NetworkRuleSet'->'properties'->>'DefaultAction'\
    \ AS network_rule_default_action, kaytu_description->'definitions'->'RegistryProperties'->'properties'->>'PublicNetworkAccess'\
    \ AS public_network_access\nFROM azure_container_registry\nWHERE type = 'Microsoft.ContainerRegistry/registries'\n\
    AND (\n    (network_rule_set_default_action IS NULL AND kaytu_description->'definitions'->'RegistryProperties'->'properties'->'NetworkRuleSet'->'properties'->>'DefaultAction'\
    \ = 'Allow')\n    OR network_rule_set_default_action = 'Allow'\n)\nAND (\n   \
    \ (public_network_access IS NULL AND kaytu_description->'definitions'->'RegistryProperties'->'properties'->>'PublicNetworkAccess'\
    \ = 'Enabled')\n    OR public_network_access = 'Enabled'\n)\nLIMIT 5;;\n"
Severity: ''
Title: Container registries should not allow unrestricted network access
