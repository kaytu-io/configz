Description: Enable infrastructure encryption for Azure Database for MySQL servers
  to have higher level of assurance that the data is secure. When infrastructure encryption
  is enabled, the data at rest is encrypted twice using FIPS 140-2 compliant Microsoft
  managed keys.
ID: infrastructure_encryption_should_be_enabled_for_azure_database_for_my_sql_servers
Query:
  Connector: Azure
  Engine: odysseus-v0.0.1
  QueryToExecute: 'SELECT name, id, type, state, version, user_visible_state, location,
    administrator_login, backup_retention_days, byok_enforcement, earliest_restore_date,
    fully_qualified_domain_name, geo_redundant_backup, infrastructure_encryption,
    master_server_id, minimal_tls_version, public_network_access, replica_capacity,
    replication_role, sku_capacity, sku_family, sku_name, sku_size, sku_tier, ssl_enforcement,
    storage_auto_grow, storage_mb, private_endpoint_connections, server_configurations,
    server_keys, title, tags, akas, region, resource_group, cloud_environment, kaytu_account_id,
    kaytu_resource_id, kaytu_metadata, kaytu_description, _ctx

    FROM azure_mysql_server

    WHERE type = ''Microsoft.DBforMySQL/servers'' AND (infrastructure_encryption IS
    NULL OR infrastructure_encryption != ''Enabled'')

    LIMIT 5;;

    '
Severity: ''
Title: Infrastructure encryption should be enabled for Azure Database for MySQL servers
