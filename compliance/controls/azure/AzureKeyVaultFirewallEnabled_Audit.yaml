Description: 'Enable the key vault firewall so that the key vault is not accessible
  by default to any public IPs. Optionally, you can configure specific IP ranges to
  limit access to those networks. Learn more at: https://docs.microsoft.com/azure/key-vault/general/network-security'
ID: azure_key_vault_should_have_firewall_enabled
Query:
  Connector: Azure
  Engine: odysseus-v0.0.1
  QueryToExecute: "SELECT *\nFROM azure_key_vault\nWHERE type = 'Microsoft.KeyVault/vaults'\n\
    AND (create_mode = 'default' OR kaytu_description->>'createMode' = 'default')\n\
    AND (network_acls->>'defaultAction' != 'Deny' OR kaytu_description->>'networkAcls.defaultAction'\
    \ != 'Deny')\nAND (\n    (array_length(network_acls->'ipRules', 1) > 0 AND jsonb_array_length(kaytu_description->'networkAcls.ipRules')\
    \ > 0)\n    OR\n    (array_length(network_acls->'ipRules', 1) = 0 AND jsonb_array_length(kaytu_description->'networkAcls.ipRules')\
    \ = 0)\n)\nLIMIT 5;;\n"
Severity: ''
Title: Azure Key Vault should have firewall enabled
