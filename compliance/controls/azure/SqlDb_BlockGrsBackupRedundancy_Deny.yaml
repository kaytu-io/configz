Description: 'Databases should avoid using the default geo-redundant storage for backups,
  if data residency rules require data to stay within a specific region. Note: Azure
  Policy is not enforced when creating a database using T-SQL. If not explicitly specified,
  database with geo-redundant backup storage is created via T-SQL.'
ID: sql_database_should_avoid_using_grs_backup_redundancy
Query:
  Connector: Azure
  Engine: odysseus-v0.0.1
  QueryToExecute: "SELECT *\nFROM azure_sql_database\nWHERE type = 'Microsoft.Sql/servers/databases'\n\
    AND edition != 'DataWarehouse'\nAND (\n    (\n        requestContext->>'apiVersion'\
    \ <= '2020-08-01-preview'\n        AND (\n            kaytu_description->>'storageAccountType'\
    \ != 'LRS'\n            AND kaytu_description->>'storageAccountType' != 'ZRS'\n\
    \        )\n    )\n    OR\n    (\n        requestContext->>'apiVersion' > '2020-08-01-preview'\n\
    \        AND (\n            kaytu_description->>'storageAccountType' != 'Local'\n\
    \            AND kaytu_description->>'storageAccountType' != 'Zone'\n        )\n\
    \    )\n)\nLIMIT 5;;\n"
Severity: ''
Title: SQL Database should avoid using GRS backup redundancy
