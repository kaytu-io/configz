Description: This policy audits any Key Vault not configured to use a virtual network
  service endpoint.
ID: key_vault_should_use_a_virtual_network_service_endpoint
Query:
  Connector: Azure
  Engine: odysseus-v0.0.1
  QueryToExecute: 'SELECT *

    FROM azure_key_vault

    WHERE type = ''Microsoft.KeyVault/vaults''

    AND (network_acls->>''defaultAction'' IS NULL OR network_acls->>''defaultAction''
    != ''Deny'')

    AND (network_acls->''virtualNetworkRules'' IS NULL OR NOT network_acls->''virtualNetworkRules''
    @> ''[{}]'')

    LIMIT 5;;

    '
Severity: ''
Title: Key Vault should use a virtual network service endpoint
