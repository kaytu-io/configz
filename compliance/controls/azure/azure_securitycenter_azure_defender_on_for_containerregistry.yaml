Description: Turning on Azure Defender enables threat detection for Container Registries, providing threat intelligence, anomaly detection, and behavior analytics in the Azure Security Center.
DocumentURI: ""
ID: azure_securitycenter_azure_defender_on_for_containerregistry
Managed: true
ManualVerification: false
Query:
  Connector: Azure
  Engine: odysseus-v0.0.1
  ListOfTables:
  - azure_security_center_subscription_pricing
  - azure_subscription
  PrimaryTable: azure_security_center_subscription_pricing
  QueryToExecute: |
    select
      sub_pricing.id as resource,
      sub_pricing.kaytu_account_id as kaytu_account_id,
      sub_pricing.kaytu_resource_id as kaytu_resource_id,
      case
        when pricing_tier = 'Standard' then 'ok'
        else 'alarm'
      end as status,
      case
        when pricing_tier = 'Standard' then 'Azure Defender on for Container Registry.'
        else 'Azure Defender off for Container Registry.'
      end as reason
      
      , sub.display_name as subscription
    from
      azure_security_center_subscription_pricing sub_pricing
      right join azure_subscription sub on sub_pricing.subscription_id = sub.subscription_id
    where
      name = 'ContainerRegistry';
Severity: low
Tags:
  category:
  - Compliance
  cis:
  - "true"
  cis_item_id:
  - "2.7"
  cis_level:
  - "2"
  cis_section_id:
  - "2"
  cis_type:
  - manual
  cis_version:
  - v1.3.0
  plugin:
  - azure
  service:
  - Azure/SecurityCenter
  x-kaytu-explanation:
  - |+
    The Azure Control mentioned involves activating Azure Defender for Container Registries. This action enhances security by incorporating threat detection mechanisms. The Azure Security Center utilizes threat intelligence, anomaly detection, and behavior analytics to bolster the security posture of Container Registries.

  x-kaytu-noncompliance-cost:
  - |+
    The cost of non-compliance with the Azure Control of enabling Azure Defender for Container Registries can be significant. Without the threat detection and security measures provided by Azure Defender, Container Registries may be more susceptible to various threats. This could lead to potential security breaches, data compromise, and reputational damage. The specific financial impact would depend on the nature and scale of the security incidents that could occur in the absence of compliance.

  x-kaytu-usefulness-example:
  - |+
    An example instance showcasing the usefulness of enabling Azure Defender for Container Registries is when a malicious actor attempts to exploit vulnerabilities in the registry. Azure Defender, through its threat detection capabilities, identifies the anomalous behavior and potential security threats in real-time. For instance, if an unauthorized user tries to access sensitive container images or if there's an unusual spike in network activity, Azure Defender can promptly alert security teams. This timely detection and response help prevent security breaches, ensuring the integrity and confidentiality of the containerized applications and data in the Azure Security Center.






Title: Ensure that Azure Defender is set to On for Container Registries
