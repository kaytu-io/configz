Description: 'Azure Private Link lets you connect your virtual network to Azure services
  without a public IP address at the source or destination. The Private Link platform
  handles the connectivity between the consumer and services over the Azure backbone
  network. By mapping private endpoints to your Event Grid topic instead of the entire
  service, you''ll also be protected against data leakage risks. Learn more at: https://aka.ms/privateendpoints.'
ID: azure_event_grid_topics_should_use_private_link
Query:
  Connector: Azure
  Engine: odysseus-v0.0.1
  QueryToExecute: "SELECT *\nFROM azure_eventgrid_topic\nWHERE type = 'Microsoft.EventGrid/topics'\n\
    AND (kind = 'AzureArc' OR kaytu_description->>'kind' = 'AzureArc')\nAND (\n  \
    \  (private_endpoint_connections IS NOT NULL AND private_endpoint_connections->>'privateLinkServiceConnectionState'->>'status'\
    \ = 'Approved')\n    OR\n    (kaytu_description->'privateEndpointConnections'->'$.Topic.PrivateEndpointConnections'\
    \ IS NOT NULL AND kaytu_description->'privateEndpointConnections'->>'$.Topic.PrivateEndpointConnections'->'privateLinkServiceConnectionState'->>'status'\
    \ = 'Approved')\n)\nLIMIT 5;;\n"
Severity: ''
Title: Azure Event Grid topics should use private link
