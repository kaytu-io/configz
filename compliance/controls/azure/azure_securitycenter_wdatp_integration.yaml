Description: This setting enables Windows Defender ATP (WDATP) integration with Security Center.
DocumentURI: ""
ID: azure_securitycenter_wdatp_integration
Managed: true
ManualVerification: false
Query:
  Connector: Azure
  Engine: odysseus-v0.0.1
  ListOfTables:
  - azure_security_center_setting
  - azure_subscription
  PrimaryTable: azure_security_center_setting
  QueryToExecute: |
    select
      sc_sett.id as resource,
      sc_sett.kaytu_account_id as kaytu_account_id,
      sc_sett.kaytu_resource_id as kaytu_resource_id,
      case
        when enabled then 'ok'
        else 'alarm'
      end as status,
      case
        when enabled then 'Microsoft Cloud App Security (MCAS) integrated with Security Center.'
        else 'Microsoft Cloud App Security (MCAS) not integrated with Security Center.'
      end as reason
      
      , sub.display_name as subscription
    from
      azure_security_center_setting sc_sett
      right join azure_subscription sub on sc_sett.subscription_id = sub.subscription_id
    where
      name = 'WDATP';
Severity: high
Tags:
  category:
  - Compliance
  cis:
  - "true"
  cis_item_id:
  - "2.9"
  cis_level:
  - "2"
  cis_section_id:
  - "2"
  cis_type:
  - manual
  cis_version:
  - v1.3.0
  plugin:
  - azure
  service:
  - Azure/SecurityCenter
  x-kaytu-explanation:
  - "**Azure Control: Windows Defender ATP Integration with Security Center**\n\n*Description:*\nThis Azure Control setting facilitates the integration between Windows Defender Advanced Threat Protection (WDATP) and Security Center. When enabled, it establishes a connection between these two security solutions, allowing for a seamless and comprehensive approach to threat detection, analysis, and response.\n\n*Functionality:*\nEnabling this setting ensures that Windows Defender ATP, a sophisticated threat intelligence and protection service, collaborates with Azure Security Center. This integration enhances the overall security posture by leveraging the combined capabilities of both solutions. Security Center can utilize insights and alerts from WDATP to provide a unified and consolidated view of security events, enabling more effective monitoring and response to potential threats.\n\n*Key Benefits:*\n1. **Unified Security Monitoring:** Receive consolidated security alerts and insights from Windows Defender ATP within Azure Security Center.\n2. **Enhanced Threat Detection:** Leverage the advanced threat detection capabilities of Windows Defender ATP to strengthen Security Center's threat intelligence.\n3. **Streamlined Incident Response:** Improve incident response times by accessing comprehensive threat information and insights in a unified dashboard.\n\n*How to Enable:*\nTo activate this integration, navigate to the Azure Security Center portal and locate the relevant settings for Windows Defender ATP integration. Follow the provided instructions to establish the connection and enhance your organization's overall security posture.\n\n*Note:*\nEnsure that proper permissions and prerequisites are in place for successful integration between Windows Defender ATP and Azure Security Center.\n"
  x-kaytu-noncompliance-cost:
  - |-
    The cost of non-compliance with the Azure Control that enables Windows Defender ATP (WDATP) integration with Security Center can be significant. Non-compliance may result in various consequences, including but not limited to:

    Security Vulnerabilities:

    Without the integration, there may be gaps in threat detection and response capabilities.
    Increased risk of overlooking or missing critical security incidents.
    Limited Visibility:

    Lack of synchronized data between Windows Defender ATP and Security Center may lead to incomplete insights into the overall security posture.
    Reduced ability to correlate and analyze security events across the environment.
    Delayed Incident Response:

    Integration facilitates faster incident detection and response. Without it, the organization may experience delays in identifying and mitigating security incidents.
    Compliance Risks:

    Non-compliance with this control may lead to violations of regulatory requirements and industry standards.
    Auditors may flag the organization for not adhering to recommended security practices.
    Increased Operational Costs:

    Manual efforts may be required for threat hunting and incident response, leading to higher operational costs.
    Inefficient use of resources in managing security incidents without the automated capabilities provided by the integration.
    Reputation Damage:

    Security incidents resulting from non-compliance can harm the organization's reputation.
    Stakeholders may lose trust in the organization's ability to maintain a secure IT environment.
    Missed Optimization Opportunities:

    The integration often provides optimization recommendations based on the combined data from WDATP and Security Center. Without it, the organization may miss opportunities to enhance its security configuration.
    To mitigate these risks and ensure a robust security posture, it is essential to comply with the Azure Control for Windows Defender ATP integration with Security Center. Regular monitoring, timely response to alerts, and adherence to recommended security best practices are critical components of maintaining a secure and compliant environment.
  x-kaytu-usefulness-example:
  - " Below is an example instance of how you might use the mentioned Azure control in a markup format. In this case, I'll use YAML as an example markup language commonly used in configuration files:\n\n\nresource \"azurerm_security_center_contact\" \"example_contact\" {\n  name          = \"security-contact\"\n  email         = \"security@example.com\"\n  phone         = \"123-456-7890\"\n  alert_notifications = true\n}\n\nresource \"azurerm_security_center_subscription_pricing\" \"example_pricing\" {\n  tier = \"standard\"\n}\n\nresource \"azurerm_security_center_auto_provisioning\" \"example_auto_provisioning\" {\n  name                = \"default\"\n  auto_provision      = true\n  target_security_center_subscription = azurerm_security_center_subscription_pricing.example_pricing.id\n}\n\nresource \"azurerm_security_center_security_contact_association\" \"example_association\" {\n  security_center_subscription_pricing_id = azurerm_security_center_subscription_pricing.example_pricing.id\n  security_contact_id                    = azurerm_security_center_contact.example_contact.id\n}\n\nresource \"azurerm_security_center_automation\" \"example_automation\" {\n  name              = \"wdatp-integration\"\n  automation_account_id = azurerm_automation_account.example.id\n}\n\nresource \"azurerm_security_center_auto_provisioning\" \"example_wdatp_auto_provisioning\" {\n  name                 = \"wdatp-provisioning\"\n  auto_provision       = true\n  target_automation_account_id = azurerm_security_center_automation.example_automation.id\n}\n\nresource \"azurerm_security_center_pricing\" \"example_wdatp_pricing\" {\n  tier = \"standard\"\n}\n\nresource \"azurerm_security_center_policy\" \"example_wdatp_policy\" {\n  name                  = \"wdatp-policy\"\n  security_center_subscription_pricing_id = azurerm_security_center_pricing.example_wdatp_pricing.id\n}\n\nresource \"azurerm_security_center_setting\" \"example_wdatp_setting\" {\n  name                               = \"wdatp-integration\"\n  security_center_subscription_pricing_id = azurerm_security_center_subscription_pricing.example_wdatp_pricing.id\n  setting {\n    setting_name = \"WdatpIntegration\"\n    setting_data {\n      enabled = true\n    }\n  }\n}\nIn this example:\n\nWe first define a security contact, subscription pricing, and auto-provisioning settings for Security Center.\nThen, we associate a security contact with the subscription pricing.\nNext, we set up an automation account and configure auto-provisioning for Windows Defender ATP (WDATP).\nWe define WDATP pricing, policy, and eventually, the setting to enable WDATP integration with Security Center.\nPlease note that this is a simplified example, and you may need to adapt it to your specific needs and infrastructure setup."
Title: Ensure that Windows Defender ATP (WDATP) integration with Security Center is selected
